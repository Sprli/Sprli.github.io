<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Hexo</title>
  
  
  <link href="https://sprli.github.io/atom.xml" rel="self"/>
  
  <link href="https://sprli.github.io/"/>
  <updated>2023-06-23T13:41:56.148Z</updated>
  <id>https://sprli.github.io/</id>
  
  <author>
    <name>æç¥–ä¹</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>GitHubæ“ä½œå¸¸ç”¨æŒ‡ä»¤</title>
    <link href="https://sprli.github.io/2023/06/19/github_command/"/>
    <id>https://sprli.github.io/2023/06/19/github_command/</id>
    <published>2023-06-19T13:00:47.859Z</published>
    <updated>2023-06-23T13:41:56.148Z</updated>
    
    <content type="html"><![CDATA[<ul><li><p>git config --global</p></li><li><p>git pull origin main<br>ä¿æŒæœ¬åœ°ä¸GitHubä»“åº“å†…å®¹ä¸€è‡´</p></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;git config --global&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;git pull origin main&lt;br&gt;
ä¿æŒæœ¬åœ°ä¸GitHubä»“åº“å†…å®¹ä¸€è‡´&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>å…³äºåœ¨Jetsonéƒ¨ç½²Yolov5å®ç°æ£€æµ‹ä¸ä¸²å£é€šä¿¡ä¼ é€ä½ç½®ä¿¡æ¯</title>
    <link href="https://sprli.github.io/2023/06/14/ocean_competC2/"/>
    <id>https://sprli.github.io/2023/06/14/ocean_competC2/</id>
    <published>2023-06-14T03:27:11.440Z</published>
    <updated>2023-07-06T04:19:47.511Z</updated>
    
    <content type="html"><![CDATA[<p>è¿™ç¯‡åšå®¢ç”¨æ¥è®°å½•å‚åŠ æµ·èµ›C2è¿‡ç¨‹ä¸­ï¼Œå¦‚ä½•å®ç°åœ¨Jetson Nanoä¸Šéƒ¨ç½²ç›®æ ‡æ£€æµ‹ç®—æ³•ä»¥åŠä½¿ç”¨ä¸²å£é€šä¿¡çš„æ–¹æ³•ã€‚</p><h3 id="æ•°æ®æ ‡æ³¨ä¸æ¨¡å‹è®­ç»ƒ">æ•°æ®æ ‡æ³¨ä¸æ¨¡å‹è®­ç»ƒ</h3><h4 id="YoloV5çš„ä½¿ç”¨ä¸ç®€å•è®²è§£">YoloV5çš„ä½¿ç”¨ä¸ç®€å•è®²è§£</h4><p>Yolov5æ¨¡å‹ç›®å‰åœ¨ç½‘ç»œä¸Šå·²ç»ç»è¿‡äº†è®¸å¤šè€ƒéªŒï¼Œä¸”å…¶Githubå®˜æ–¹ä¹Ÿä»åœ¨ä¸æ–­æ›´æ–°ï¼Œå…¶ç›¸å…³å¹³å°çš„éƒ¨ç½²åœ¨å®˜ç½‘ä¹Ÿæœ‰å¾ˆå¤šæ•™ç¨‹ï¼Œæ‰€ä»¥å¦‚æœæƒ³åœ¨åµŒå…¥å¼å¹³å°éƒ¨ç½²ç›®æ ‡æ£€æµ‹ä»¥åŠåˆ†ç±»ç½‘ç»œï¼Œé€‰æ‹©Yolov5å¯ä»¥å¸¦ç»™æˆ‘ä»¬æå¤§çš„ä¾¿åˆ©ï¼Œè¿™ä¹Ÿæ˜¯æˆ‘é€‰æ‹©ä½¿ç”¨Yolov5çš„åŸå› ã€‚ä»¥ä¸‹å†…å®¹éƒ½æ˜¯åŸºäºYolov5ç›®æ ‡æ£€æµ‹æ¨¡å‹çš„éƒ¨ç½²ã€‚</p><h4 id="æ•°æ®é›†çš„æ ‡æ³¨ï¼ˆä½¿ç”¨Labelimgè¿›è¡Œæ•°æ®æ ‡æ³¨ï¼‰">æ•°æ®é›†çš„æ ‡æ³¨ï¼ˆä½¿ç”¨Labelimgè¿›è¡Œæ•°æ®æ ‡æ³¨ï¼‰</h4><ol><li><p>å®‰è£…labelimg<br>è¿™é‡Œæ˜¯åœ¨Anacondaç¯å¢ƒä¸‹çš„å®‰è£…</p><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">conda create -n label python&#x3D;&#x3D;3.9 # æ³¨æ„è¿™é‡Œå¿…é¡»æ˜¯python3.9ç‰ˆæœ¬ï¼Œå¦åˆ™å®‰è£…ä¼šå¯¼è‡´æ— æ³•æ­£å¸¸ä½¿ç”¨conda activate label # æ¿€æ´»ç¯å¢ƒpip install labelimg # ä½¿ç”¨pipå®‰è£…labelimglabelimg # è¿™æ˜¯æ‰“å¼€labelimgç•Œé¢çš„æŒ‡ä»¤<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>æ‰“å¼€labelimgå¹¶é…ç½®ä¿¡æ¯<br>è¾“å…¥å‘½ä»¤ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">labelimg<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä¹‹åä¼šè¿›å…¥å¦‚ä¸‹ç•Œé¢<br><img src="/images/OceanC2/1.png" style="zoom: 100%;" /></p><ul><li>è¿™é‡Œä¸»è¦éœ€è¦é…ç½®ä¸Šå›¾ä¸­ä¸‰ä¸ªçº¢åœˆé€‰é¡¹<br>å…ˆç®€å•ä»‹ç»ä¸€ä¸‹ï¼š<ul><li>Open Dirï¼šè¿™é‡Œæ˜¯æ‰“å¼€ä½ å­˜æ”¾å›¾ç‰‡çš„æ–‡ä»¶å¤¹</li><li>Change Save Dirï¼šè¿™é‡Œæ˜¯ä½ å›¾ç‰‡æ ‡æ³¨çš„æ ‡ç­¾æ•°æ®å­˜æ”¾ä½ç½®</li><li>Yoloï¼šè¿™ä¸ªæ˜¯é€‰æ‹©æ ‡æ³¨æ•°æ®çš„æ ¼å¼ï¼Œå…¶ä¸­æœ‰å¾ˆå¤šä¸ªé€‰é¡¹ï¼Œæ ¹æ®è‡ªå·±æ¨¡å‹è®­ç»ƒæ‰€éœ€çš„æ ‡ç­¾ç±»å‹è¿›è¡Œé€‰æ‹©ï¼Œè¿™é‡Œé€‰æ‹©yoloå› ä¸ºæˆ‘è®­ç»ƒçš„æ•°æ®æ ‡ç­¾è¦æ±‚æ˜¯Yoloç±»å‹ã€‚</li></ul></li></ul></li><li><p>è¿›è¡Œæ•°æ®æ ‡æ³¨<br>å½“æŠŠä¸Šè¿°é…ç½®å‡†å¤‡å·¥ä½œå®Œæˆåï¼Œå°±å¯ä»¥å¼€å§‹æ•°æ®æ ‡æ³¨äº†å•¦ï¼Œå¦‚ä¸‹è§†é¢‘æ‰€ç¤ºï¼š<br><video id="video" controls="" preload="none" poster="å°é¢"><br><source id="mp4" src="/videos/labelimg_video1.mp4" type="video/mp4"><br></videos><br>å¦‚ä¸Šè§†é¢‘æ‰€ç¤ºï¼Œå¯¹æ•°æ®è¿›è¡Œæ ‡æ³¨ã€‚è¿™é‡Œä»‹ç»æœ€å¸¸ä½¿ç”¨çš„å¿«æ·é”®ï¼Œå¯ä»¥å¸®åŠ©æ›´å¿«åœ°è¿›è¡Œæ•°æ®æ ‡æ³¨å·¥ä½œï¼š</p><ul><li>Wé”®ï¼šæ˜¾ç¤ºåå­—å…‰æ ‡ï¼Œå‡ºç°åå­—å…‰æ ‡åå³å¯é…åˆé¼ æ ‡æ¡†ä½ç›®æ ‡</li><li>Dé”®ï¼šä¸‹ä¸€å¼ å›¾ç‰‡</li><li>Aé”®ï¼šä¸Šä¸€å¼ å›¾ç‰‡</li><li>Ctrl+Sé”®ï¼šå¯¹å½“å‰æ“ä½œè¿›è¡Œä¿å­˜</li><li>Ctrl+é¼ æ ‡æ»šè½®ï¼šå¯¹å›¾ç‰‡ä¸Šé¼ æ ‡æ‰€æŒ‡åŒºåŸŸè¿›è¡Œæ”¾å¤§å’Œç¼©å°æ“ä½œ<br>ä¸€èˆ¬æ¥è¯´ï¼ŒçŸ¥é“ä¸Šè¿°å››ç§å¿«æ·é”®å³å¯å¸®åŠ©ä½ è¿›è¡Œå¿«æ·æ ‡æ³¨æ•°æ®å•¦</li></ul></li></ol><h4 id="è¿›è¡Œè®­ç»ƒ">è¿›è¡Œè®­ç»ƒ</h4><p>åœ¨æ ‡æ³¨å®Œæ•°æ®åï¼Œå‰©ä¸‹çš„å°±æ˜¯æ ¸å¿ƒç¯èŠ‚ï¼šè®­ç»ƒæ¨¡å‹</p><ol><li><p>ä¸‹è½½å®˜æ–¹æºç <br>é¦–å…ˆä»Yolov5å®˜æ–¹Githubä¸Šcloneå…¶ä»£ç ï¼š<a href="https://github.com/ultralytics/yolov5">https://github.com/ultralytics/yolov5</a><br>å¯ä»¥ä½¿ç”¨ä¸¤ç§æ–¹å¼ä¸‹è½½å…¶ä»£ç ï¼š</p><ul><li><p>æ–¹æ³•ä¸€ï¼šä½¿ç”¨git cloneå‘½ä»¤ä¸‹è½½ï¼š<br><img src="/images/OceanC2/2.png" style="zoom: 100%;" /><br>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œcopyå½“å‰githubä¸‹è½½é“¾æ¥ï¼Œç„¶ååœ¨ä½ çš„è™šæ‹Ÿç¯å¢ƒä¸‹è¾“å…¥å‘½ä»¤ï¼š</p><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">git clone git@github.com:ultralytics&#x2F;yolov5.git  # è¿™æ¡æŒ‡ä»¤ä¼šåœ¨ä½ çš„å½“å‰è·¯å¾„ä¸‹è½½Yolov5æ–‡ä»¶<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¦‚æœå¤±è´¥äº†ï¼Œæ˜¾ç¤ºæ²¡æœ‰æ‰¾åˆ°gitå‘½ä»¤ï¼Œé‚£ä¹ˆå°±æ˜¯å½“å‰ä½ çš„è™šæ‹Ÿç¯å¢ƒæ²¡æœ‰å®‰è£…gitï¼Œä½¿ç”¨conda install git æˆ–è€… pip install gitå‘½ä»¤è¿›è¡Œå®‰è£…<br>å¦‚æœå¤±è´¥äº†ï¼Œæ˜¾ç¤ºæ˜¯ç½‘ç»œé—®é¢˜ï¼Œé‚£ä¹ˆå¯èƒ½ä½ éœ€è¦æŒ‚æ¢¯å­æ‰å¯ä»¥ã€‚å¦‚æœä»ç„¶æ— æ³•è§£å†³ï¼Œé‚£ä¹ˆå°±å°è¯•å¼€å…³é‡å¯ã€‚</p></li><li><p>æ–¹æ³•äºŒï¼šç›´æ¥ä»å®˜ç½‘ä¸‹è½½zipæ–‡ä»¶ï¼š<br><img src="/images/OceanC2/3.png" style="zoom: 100%;" /><br>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œç‚¹å‡»çº¢åœˆé€‰é¡¹ï¼Œä¸‹è½½zipæ–‡ä»¶ï¼Œéšåå°†å…¶è§£å‹å³å¯å¾—åˆ°Yolov5å®˜æ–¹æ–‡ä»¶</p></li></ul></li><li><p>é…ç½®æ¨¡å‹è®­ç»ƒç›¸å…³ä¿¡æ¯<br>ç„¶åè¿›å…¥æ–‡ä»¶ç›®å½•ï¼Œåœ¨dataæ–‡ä»¶å¤¹ä¸‹åˆ›å»ºä¸€ä¸ªC2.yamlæ–‡ä»¶ï¼Œå…¶å†…å®¹å¦‚ä¸‹ï¼š</p> <pre class="line-numbers language-c++" data-language="c++"><code class="language-c++"># YOLOv5 ğŸš€ by Ultralytics, AGPL-3.0 license# COCO128 dataset https:&#x2F;&#x2F;www.kaggle.com&#x2F;ultralytics&#x2F;coco128 (first 128 images from COCO train2017) by Ultralytics# Example usage: python train.py --data coco128.yaml# parent# â”œâ”€â”€ yolov5# â””â”€â”€ datasets#     â””â”€â”€ coco128  â† downloads here (7 MB)# Train&#x2F;val&#x2F;test sets as 1) dir: path&#x2F;to&#x2F;imgs, 2) file: path&#x2F;to&#x2F;imgs.txt, or 3) list: [path&#x2F;to&#x2F;imgs1, path&#x2F;to&#x2F;imgs2, ..]path: ..&#x2F;datasets&#x2F;coco128  # dataset root dirtrain: images&#x2F;train2017  # train images (relative to &#39;path&#39;) 128 imagesval: images&#x2F;train2017  # val images (relative to &#39;path&#39;) 128 imagestest:  # test images (optional)# Classesnames:  0: hole<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ–‡ä»¶è·¯å¾„ä»¥åŠå†…å®¹è¯¦ç»†å‚è€ƒä»¥ä¸‹å›¾ç‰‡ï¼š<br><img src="/images/OceanC2/5.png" style="zoom: 100%;" /><br>å…¶ä¸­ï¼š</p><ul><li>pathï¼šæ˜¯æŒ‡æ ¹ç›®å½•çš„è·¯å¾„</li><li>trainï¼šæ˜¯æŒ‡è¦è®­ç»ƒçš„å›¾ç‰‡å­˜æ”¾ä½ç½®</li><li>valï¼šæ˜¯æŒ‡è¦éªŒè¯çš„å›¾ç‰‡å­˜æ”¾ä½ç½®ï¼ˆè¿™é‡Œå’Œtrainä¿æŒä¸€è‡´å³å¯ï¼‰</li><li>nameï¼šç±»åˆ«å­˜æ”¾ä½ç½®ï¼Œå¦‚å›¾ä¸­æ‰€ç¤ºï¼š0è¡¨ç¤ºç›®æ ‡ç±»åˆ«ç´¢å¼•ï¼ˆä»0å¼€å§‹ï¼‰ï¼Œholeè¡¨ç¤ºå…¶ä»£è¡¨çš„ç±»åˆ«åç§°</li></ul><p>è¿™é‡Œå†é™„ä¸Šä¸€å¼ è®­ç»ƒæ•°æ®å­˜æ”¾çš„æ–‡ä»¶å¤¹è·¯å¾„åŠå†…å®¹ï¼š<br><img src="/images/OceanC2/6.png" style="zoom:100%;" /><br>è¿™é‡Œåªéœ€è¦å…³æ³¨ç™½è‰²åœˆä¸­çš„ä¸¤ä¸ªæ–‡ä»¶å¤¹datasetä¸yolov5ï¼Œå…¶ä¸­è·¯å¾„ç›¸å¯¹ä½ç½®å¦‚ä¸‹ï¼š</p> <pre class="line-numbers language-c++" data-language="c++"><code class="language-c++"># parent# â”œâ”€â”€ yolov5# â””â”€â”€ datasets#     â””â”€â”€ coco128#         â””â”€â”€ images#             â””â”€â”€ train2017 # æ–‡ä»¶å¤¹ä¸‹æ˜¯è®­ç»ƒå›¾ç‰‡#         â””â”€â”€ labels#             â””â”€â”€ train2017 # æ–‡ä»¶å¤¹ä¸‹æ˜¯è®­ç»ƒå›¾ç‰‡å¯¹åº”çš„æ ‡æ³¨æ–‡ä»¶<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ol><p>ä¹‹åæŒ‰ç…§å®˜æ–¹æ–‡æ¡£è¿›è¡Œé…ç½®ä½ çš„è™šæ‹Ÿç¯å¢ƒï¼Œé…ç½®å®Œæˆåå³å¯ä½¿ç”¨ç»ˆç«¯åœ¨å½“å‰è·¯å¾„ä¸‹è¾“å…¥ä»¥ä¸‹å‘½ä»¤è¿›è¡Œè®­ç»ƒï¼š</p><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">python train.py --data C2.yaml --weights yolov5n.pt --cfg yolov5n.yaml --img 640  --batch-size 4<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æŒ‡ä»¤è§£é‡Šï¼š</p><ul><li>â€“dataï¼šC2.yamlä¸ºå‰é¢æ‰€åˆ›å»ºçš„æ–‡ä»¶ï¼Œé‡Œé¢å­˜æ”¾çš„æ˜¯é…ç½®è®­ç»ƒæ•°æ®çš„ç›¸å…³å†…å®¹</li><li>â€“weightsï¼š yolov5n.ptæ˜¯æŒ‡ä½¿ç”¨å®˜æ–¹çš„yolov5né¢„è®­ç»ƒæ¨¡å‹æ¥è¿›è¡Œè¿ç§»å­¦ä¹ è®­ç»ƒ</li><li>â€“cfgï¼šyolov5n.yamlæ–‡ä»¶æ—¶æ¨¡å‹çš„ç»“æ„æ–‡ä»¶</li><li>â€“imgï¼š640æ˜¯æŒ‡é€è¿›æ¨¡å‹è¿›è¡Œè®­ç»ƒçš„å›¾ç‰‡å°ºå¯¸ï¼Œ640è¡¨ç¤º640x640ã€‚æ³¨æ„æ­¤æ•°å­—åº”ä¸º32çš„æ•´æ•°å€ï¼Œä¸ç„¶è®­ç»ƒä¼šå‡ºé”™</li><li>â€“batch-sizeï¼š4æ˜¯æŒ‡ä¸€æ¬¡é€å…¥æ¨¡å‹è®­ç»ƒçš„å›¾ç‰‡ä¸ªæ•°ä¸º4ï¼Œè¿™ä¸€é¡¹å’Œä½ çš„GPUæ€§èƒ½ç›¸è”ç³»ï¼Œbatch-sizeè¿‡å¤§ä¼šå¯¼è‡´ä½ çš„GPUå› ä¸ºæ˜¾å­˜ä¸å¤Ÿè€Œæ— æ³•è®­ç»ƒã€‚</li></ul><p>å¦‚æœä¸Šè¿°å‘½ä»¤è¾“å…¥åæ˜¾ç¤ºé”™è¯¯ï¼Œä¸€èˆ¬æ¥è¯´æ˜¯ä½ çš„batch-sizeè®¾ç½®è¿‡å¤§äº†ï¼Œè°ƒå°å³å¯ï¼Œå¦‚2æˆ–1ã€‚<br>å½“ç„¶è¿˜æœ‰ä¸€ä¸ªå‰ææ˜¯ï¼Œä½ æŒ‰ç…§å®˜æ–¹æ–‡æ¡£æˆåŠŸé…ç½®å¥½äº†ä½ çš„è™šæ‹Ÿç¯å¢ƒï¼Œå¦‚pytorchã€cudaç­‰ã€‚</p><p>è®­ç»ƒå®Œæˆåï¼Œä½ çš„æ¨¡å‹å­˜æ”¾åœ¨å¦‚ä¸‹è·¯å¾„ï¼š</p><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++"># parent# â”œâ”€â”€ yolov5#     â””â”€â”€ runs#         â””â”€â”€ train#             â””â”€â”€ exp # ä¸ä¸€å®šæ˜¯expï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯exp+ä¸€ä¸ªæ•°å­—#                 â””â”€â”€ weights#                     â””â”€â”€ best.pt # è¿™æ˜¯è®­ç»ƒå¾—åˆ°çš„æœ€ä¼˜çš„æƒé‡<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="å®‰è£…rosï¼Œä»¥è¿›è¡Œä¸²å£é€šä¿¡">å®‰è£…rosï¼Œä»¥è¿›è¡Œä¸²å£é€šä¿¡</h3><p>è¿™é‡Œå…ˆé™„ä¸Šjetson nanoçš„å¼•è„šå›¾<br><img src="/images/OceanC2/7.png" style="zoom:100%;" /></p><h4 id="é¦–å…ˆè¿›è¡Œæ¢æº">é¦–å…ˆè¿›è¡Œæ¢æº</h4><ol><li>å¤‡ä»½æºï¼Œé˜²æ­¢æ“ä½œé”™è¯¯ä»¥å¤ç”¨<br><code>cp /etc/apt/sources.list   /etc/apt/sources.list.bak</code></li><li>ç¼–è¾‘æºæ–‡ä»¶ï¼Œæ·»åŠ é•œåƒ<br><code>sudo gedit /etc/apt/sources.list</code></li><li>åœ¨æ‰“å¼€çš„æºæ–‡ä»¶ä¸­ï¼Œå°†åŸå†…å®¹åˆ é™¤ï¼Œç„¶åæ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š</li></ol><ul><li>æ¸…åæºï¼š<pre class="line-numbers language-c++" data-language="c++"><code class="language-c++"># é»˜è®¤æ³¨é‡Šäº†æºç é•œåƒä»¥æé«˜ apt update é€Ÿåº¦ï¼Œå¦‚æœ‰éœ€è¦å¯è‡ªè¡Œå–æ¶ˆæ³¨é‡Šdeb https:&#x2F;&#x2F;mirrors.tuna.tsinghua.edu.cn&#x2F;ubuntu-ports&#x2F; bionic main restricted universe multiverse# deb-src https:&#x2F;&#x2F;mirrors.tuna.tsinghua.edu.cn&#x2F;ubuntu-ports&#x2F; bionic main restricted universe multiversedeb https:&#x2F;&#x2F;mirrors.tuna.tsinghua.edu.cn&#x2F;ubuntu-ports&#x2F; bionic-updates main restricted universe multiverse# deb-src https:&#x2F;&#x2F;mirrors.tuna.tsinghua.edu.cn&#x2F;ubuntu-ports&#x2F; bionic-updates main restricted universe multiversedeb https:&#x2F;&#x2F;mirrors.tuna.tsinghua.edu.cn&#x2F;ubuntu-ports&#x2F; bionic-backports main restricted universe multiverse# deb-src https:&#x2F;&#x2F;mirrors.tuna.tsinghua.edu.cn&#x2F;ubuntu-ports&#x2F; bionic-backports main restricted universe multiversedeb https:&#x2F;&#x2F;mirrors.tuna.tsinghua.edu.cn&#x2F;ubuntu-ports&#x2F; bionic-security main restricted universe multiverse# deb-src https:&#x2F;&#x2F;mirrors.tuna.tsinghua.edu.cn&#x2F;ubuntu-ports&#x2F; bionic-security main restricted universe multiversedeb https:&#x2F;&#x2F;mirrors.tuna.tsinghua.edu.cn&#x2F;ubuntu-ports&#x2F; bionic-proposed main restricted universe multiversedeb-src https:&#x2F;&#x2F;mirrors.tuna.tsinghua.edu.cn&#x2F;ubuntu-ports&#x2F; bionic-proposed main restricted universe multiverse<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li>ä¸­ç§‘å¤§æºï¼š<pre class="line-numbers language-c++" data-language="c++"><code class="language-c++"># é»˜è®¤æ³¨é‡Šäº†æºç é•œåƒä»¥æé«˜ apt update é€Ÿåº¦ï¼Œå¦‚æœ‰éœ€è¦å¯è‡ªè¡Œå–æ¶ˆæ³¨é‡Šdeb http:&#x2F;&#x2F;mirrors.ustc.edu.cn&#x2F;ubuntu-ports bionic main restricted universe multiverse# deb-src http:&#x2F;&#x2F;mirrors.ustc.edu.cn&#x2F;ubuntu-ports bionic main restricted universe multiversedeb http:&#x2F;&#x2F;mirrors.ustc.edu.cn&#x2F;ubuntu-ports bionic-updates main restricted universe multiverse# deb-src http:&#x2F;&#x2F;mirrors.ustc.edu.cn&#x2F;ubuntu-ports bionic-updates main restricted universe multiversedeb http:&#x2F;&#x2F;mirrors.ustc.edu.cn&#x2F;ubuntu-ports bionic-backports main restricted universe multiverse# deb-src http:&#x2F;&#x2F;mirrors.ustc.edu.cn&#x2F;ubuntu-ports bionic-backports main restricted universe multiversedeb http:&#x2F;&#x2F;mirrors.ustc.edu.cn&#x2F;ubuntu-ports bionic-security main restricted universe multiverse# deb-src http:&#x2F;&#x2F;mirrors.ustc.edu.cn&#x2F;ubuntu-ports bionic-security main restricted universe multiversedeb http:&#x2F;&#x2F;mirrors.ustc.edu.cn&#x2F;ubuntu-ports bionic-proposed main restricted universe multiversedeb-src http:&#x2F;&#x2F;mirrors.ustc.edu.cn&#x2F;ubuntu-ports bionic-proposed main restricted universe multiverse<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li>é˜¿é‡Œæºï¼š<pre class="line-numbers language-c++" data-language="c++"><code class="language-c++"># é»˜è®¤æ³¨é‡Šäº†æºç é•œåƒä»¥æé«˜ apt update é€Ÿåº¦ï¼Œå¦‚æœ‰éœ€è¦å¯è‡ªè¡Œå–æ¶ˆæ³¨é‡Šdeb https:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;ubuntu-ports&#x2F; bionic main restricted universe multiverse# deb-src https:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;ubuntu-ports&#x2F; bionic main restricted universe multiversedeb https:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;ubuntu-ports&#x2F; bionic-updates main restricted universe multiverse# deb-src https:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;ubuntu-ports&#x2F; bionic-updates main restricted universe multiversedeb https:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;ubuntu-ports&#x2F; bionic-backports main restricted universe multiverse# deb-src https:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;ubuntu-ports&#x2F;s bionic-backports main restricted universe multiversedeb https:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;ubuntu-ports&#x2F; bionic-security main restricted universe multiverse# deb-src https:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;ubuntu-ports&#x2F; bionic-security main restricted universe multiversedeb https:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;ubuntu-ports&#x2F; bionic-proposed main restricted universe multiversedeb-src https:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;ubuntu-ports&#x2F; bionic-proposed main restricted universe multiverse<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ul><ol start="4"><li>æ·»åŠ å®Œæˆåï¼Œä¿å­˜å¹¶é€€å‡ºã€‚ä½¿ç”¨ä¸‹è¿°ä¸¤æ¡å‘½ä»¤æ›´æ–°ï¼š <pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">apt</span> update<span class="token function">sudo</span> <span class="token function">apt</span> upgrade <span class="token parameter variable">-y</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li><li>æ›´æ¢ROSçš„å›½å†…æºï¼ˆä¸¤æ¡æŒ‡ä»¤å·®ä¸å¤šï¼Œç¬¬ä¸€ä¸ªæ˜¯å›½å¤–ï¼Œç¬¬äºŒä¸ªæ˜¯ä¸­ç§‘å¤§çš„æºï¼Œé€‰æ‹©ä¸€ä¸ªå³å¯ï¼‰ <pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">sh</span> <span class="token parameter variable">-c</span> <span class="token string">'echo "deb http://packages.ros.org/ros/ubuntu $(lsb_release -sc) main" > /etc/apt/sources.list.d/ros-latest.list'</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre> <pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">sh</span> <span class="token parameter variable">-c</span> <span class="token string">'. /etc/lsb-release &amp;&amp; echo "deb http://mirrors.ustc.edu.cn/ros/ubuntu/ `lsb_release -cs` main" > /etc/apt/sources.list.d/ros-latest.list'</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li><li>ç„¶åå†ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤æ›´æ–°ï¼Œå®Œæˆåå³é…ç½®æˆåŠŸ <pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">apt</span> update<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li></ol><h4 id="è·å–å¯†é’¥">è·å–å¯†é’¥</h4><p>æœ‰ä¸¤ç§æ–¹æ³•ï¼Œæ¨èæ–¹æ³•ä¸€</p><ul><li>æ–¹æ³•ä¸€ï¼šå®˜ç½‘æ“ä½œ<br>å¯ä»¥è·å–æœ€æ–°çš„å¯†é’¥ï¼Œä¸ç”¨æ‹…å¿ƒå¯†é’¥æ˜¯å¦è¿‡æœŸï¼Œä½†å¯èƒ½å—ç½‘ç»œå½±å“  <pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> <span class="token function">curl</span>        <span class="token comment"># å¦‚æœä½ æ²¡æœ‰å®‰è£…curlçš„è¯ï¼Œå°±ä½¿ç”¨è¿™æ¡å‘½ä»¤</span><span class="token function">curl</span> <span class="token parameter variable">-s</span> https://raw.githubusercontent.com/ros/rosdistro/master/ros.asc <span class="token operator">|</span> <span class="token function">sudo</span> apt-key <span class="token function">add</span> -<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li><li>æ–¹æ³•äºŒï¼šç½‘ç»œæ•™ç¨‹<br>å¯†é’¥å¯èƒ½è¿‡æœŸï¼Œå¯ä»¥åˆ°ç½‘ä¸Šæœç´¢å…¶ä»–äººå‘çš„å¯†é’¥ï¼Œè¯•ä¸€è¯•<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> apt-key adv <span class="token parameter variable">--keyserver</span> keyserver.ubuntu.com --recv-keys 8D5A09DC9B929006<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li></ul><p>ç„¶åå†ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤å¯¹æºè½¯ä»¶åˆ—è¡¨è¿›è¡Œæ›´æ–°ï¼ˆåŸå…ˆå¯èƒ½æ²¡å¯†é’¥å¯¼è‡´æ›´æ–°å¤±è´¥ï¼‰</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">apt</span> update<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="å®‰è£…ROS">å®‰è£…ROS</h4><ol><li>å®‰è£…å…¨åŠŸèƒ½çš„ROSï¼Œè¿™ä¸ªå®‰è£…åŒ…å¤§æ¦‚è¶…è¿‡200Mï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> ros-melodic-desktop-full<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li><li>è®¾ç½®ç¯å¢ƒå˜é‡ <pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">echo</span> <span class="token string">"source /opt/ros/melodic/setup.bash"</span> <span class="token operator">>></span> ~/.bashrc<span class="token builtin class-name">source</span> ~/.bashrc<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li><li>å®‰è£…ç›¸å…³çš„ä¾èµ– <pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> python-rosdep python-rosinstall python-rosinstall-generator python-wstool build-essential  <span class="token function">vim</span> openconnect openssh-server<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li><li>ROSåˆå§‹åŒ–<br>ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ï¼š <pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> rosdeprosdep update<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li><li>ROSè¿è¡Œæµ‹è¯•<br>åœ¨ç»ˆç«¯åˆ†åˆ«æ‰§è¡Œä»¥ä¸‹è¯­å¥ï¼Œæµ‹è¯•å°ä¹Œé¾Ÿï¼ˆå…·ä½“ä½œç”¨æˆ‘ä¹Ÿä¸æ‡‚ï¼‰ï¼Œåªè¦èƒ½æˆåŠŸè¿è¡Œï¼Œé‚£ä¹ˆè¡¨æ˜ä½ çš„ROSå®‰è£…æˆåŠŸã€‚ <pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">roscorerosrun turtlesim turtlesim_noderosrun turtlesim turtle_teleop_key<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></li></ol><p>å¦‚æœå‡ºç° Command rosrun not found å³ rosrun å‘½ä»¤æ‰¾ä¸åˆ°çš„æƒ…å†µï¼Œè¾“å…¥ä»¥ä¸‹å‘½ä»¤å³å¯ï¼š<br><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> rosbash<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></p><h4 id="åˆ é™¤å¸è½½ROS">åˆ é™¤å¸è½½ROS</h4><p>å½“å‘ç°è‡ªå·±å®‰è£…å¤±è´¥æ— æ³•è§£å†³æ—¶ï¼Œå¯ä»¥å°è¯•é‡æ–°å¼€å§‹ï¼Œé‚£ä¹ˆå°±éœ€è¦æŠŠROSé‡æ–°è£…ä¸€éäº†ã€‚</p><ul><li>è¾“å…¥ä»¥ä¸‹å‘½ä»¤è¿›è¡ŒROSçš„åˆ é™¤å¸è½½ï¼š  <pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">apt-get</span> purge ros-*<span class="token function">sudo</span> <span class="token function">rm</span> <span class="token parameter variable">-rf</span> /etc/rosgedit ~/.bashrc   <span class="token comment"># æ‰“å¼€è¯¥æ–‡ä»¶ï¼Œåˆ é™¤å¸¦æœ‰melodicé‚£ä¸€è¡Œå³å¯</span><span class="token builtin class-name">source</span> ~/.bashrc  <span class="token comment"># åˆ·æ–°ç¯å¢ƒ</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></li></ul><h4 id="å¯èƒ½é‡åˆ°çš„é—®é¢˜æŠ¥é”™">å¯èƒ½é‡åˆ°çš„é—®é¢˜æŠ¥é”™</h4><ol><li>Could not find a package configuration file provided by â€œserialâ€œ with any serialConfig.cmake<ul><li>è¾“å…¥ä»¥ä¸‹å‘½ä»¤ <pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> ros-melodic-serial<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li></ul></li><li>æ— æ³•å®šä½åŠŸèƒ½åŒ… E: Unable to locate package ros-melodic-***<ul><li>æ–¹æ¡ˆä¸€ï¼šé¦–å…ˆä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ›´æ–°ä¸€ä¸‹ï¼Œç„¶åå†æ¬¡å®‰è£…   <pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">apt</span> update<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li><li>æ–¹æ¡ˆäºŒï¼šå¦‚æœä»ç„¶æ— æ³•ä¸‹è½½ï¼Œå°è¯•è¾“å…¥ä»¥ä¸‹å‘½ä»¤ï¼Œç„¶åå†æ¬¡å®‰è£… <pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">sh</span> <span class="token parameter variable">-c</span> <span class="token string">'echo "deb http://packages.ros.org/ros/ubuntu $(lsb_release -sc) main" > /etc/apt/sources.list.d/ros-latest.list'</span><span class="token function">sudo</span> apt-key adv <span class="token parameter variable">--keyserver</span> <span class="token string">'hkp://keyserver.ubuntu.com:80'</span> --recv-key C1CF6E31E6BADE8868B172B4F42ED6FBAB17C654<span class="token function">sudo</span> <span class="token function">apt</span> update<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></li><li>æ–¹æ¡ˆä¸‰ï¼šè¿›è¡Œæ¢æº<ul><li>å†æ¬¡æ‰“å¼€sources.listæ–‡ä»¶ï¼Œä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> gedit /etc/apt/sources.list<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li><li>åœ¨æ–‡ä»¶æœ«å°¾åŠ å…¥ä»¥ä¸‹å†…å®¹:<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">deb http://packages.ros.org/ros-shadow-fixed/ubuntu bionic main  <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li><li>ç„¶åå†æ¬¡ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ›´æ–°å®Œåï¼Œå†æ¬¡å®‰è£…ï¼š<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">apt-get</span> update<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li></ul></li></ul></li><li>sudo rosdep init æ‰¾ä¸åˆ°å‘½ä»¤<ul><li>é¦–å…ˆæŸ¥çœ‹rosdepæ˜¯å¦å®‰è£…ï¼Œä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">whereis</span> rosdep<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li><li>è‹¥æ²¡æœ‰æ˜¾ç¤ºä»»ä½•ä¿¡æ¯ï¼Œåˆ™è¡¨ç¤ºæ²¡æœ‰å®‰è£…ï¼Œç„¶åè¾“å…¥ä»¥ä¸‹å‘½ä»¤è¿›è¡Œå®‰è£…rosdepï¼š<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> python-rosdep2 <span class="token parameter variable">-y</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li></ul></li></ol><h3 id="å°†æ¨¡å‹éƒ¨ç½²åœ¨Jetson-nanoä¸Š">å°†æ¨¡å‹éƒ¨ç½²åœ¨Jetson nanoä¸Š</h3><h4 id="æ¨¡å‹æƒé‡çš„æ–‡ä»¶ç±»å‹è½¬æ¢">æ¨¡å‹æƒé‡çš„æ–‡ä»¶ç±»å‹è½¬æ¢</h4><ol><li>å°†æ¨¡å‹æƒé‡ç”±ptæ ¼å¼è½¬æ¢ä¸ºwtsæ ¼å¼</li></ol><ul><li>åœ¨yolov5æ–‡ä»¶å¤¹ä¸­åˆ›å»ºä¸€ä¸ªgen_wts.pyæ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š<pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">import sysimport argparseimport osimport structimport torchfrom utils.torch_utils import select_devicedef parse_args():    parser &#x3D; argparse.ArgumentParser(description&#x3D;&#39;Convert .pt file to .wts&#39;)    parser.add_argument(&#39;-w&#39;, &#39;--weights&#39;, required&#x3D;True,                        help&#x3D;&#39;Input weights (.pt) file path (required)&#39;)    parser.add_argument(        &#39;-o&#39;, &#39;--output&#39;, help&#x3D;&#39;Output (.wts) file path (optional)&#39;)    parser.add_argument(        &#39;-t&#39;, &#39;--type&#39;, type&#x3D;str, default&#x3D;&#39;detect&#39;, choices&#x3D;[&#39;detect&#39;, &#39;cls&#39;, &#39;seg&#39;],        help&#x3D;&#39;determines the model is detection&#x2F;classification&#39;)    args &#x3D; parser.parse_args()    if not os.path.isfile(args.weights):        raise SystemExit(&#39;Invalid input file&#39;)    if not args.output:        args.output &#x3D; os.path.splitext(args.weights)[0] + &#39;.wts&#39;    elif os.path.isdir(args.output):        args.output &#x3D; os.path.join(            args.output,            os.path.splitext(os.path.basename(args.weights))[0] + &#39;.wts&#39;)    return args.weights, args.output, args.typept_file, wts_file, m_type &#x3D; parse_args()print(f&#39;Generating .wts for &#123;m_type&#125; model&#39;)# Load modelprint(f&#39;Loading &#123;pt_file&#125;&#39;)device &#x3D; select_device(&#39;cpu&#39;)model &#x3D; torch.load(pt_file, map_location&#x3D;device)  # Load FP32 weightsmodel &#x3D; model[&#39;ema&#39; if model.get(&#39;ema&#39;) else &#39;model&#39;].float()if m_type in [&#39;detect&#39;, &#39;seg&#39;]:    # update anchor_grid info    anchor_grid &#x3D; model.model[-1].anchors * model.model[-1].stride[..., None, None]    # model.model[-1].anchor_grid &#x3D; anchor_grid    delattr(model.model[-1], &#39;anchor_grid&#39;)  # model.model[-1] is detect layer    # The parameters are saved in the OrderDict through the &quot;register_buffer&quot; method, and then saved to the weight.    model.model[-1].register_buffer(&quot;anchor_grid&quot;, anchor_grid)    model.model[-1].register_buffer(&quot;strides&quot;, model.model[-1].stride)model.to(device).eval()print(f&#39;Writing into &#123;wts_file&#125;&#39;)with open(wts_file, &#39;w&#39;) as f:    f.write(&#39;&#123;&#125;\n&#39;.format(len(model.state_dict().keys())))    for k, v in model.state_dict().items():        vr &#x3D; v.reshape(-1).cpu().numpy()        f.write(&#39;&#123;&#125; &#123;&#125; &#39;.format(k, len(vr)))        for vv in vr:            f.write(&#39; &#39;)            f.write(struct.pack(&#39;&gt;f&#39;, float(vv)).hex())        f.write(&#39;\n&#39;)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li>ç„¶ååœ¨ä½ çš„è™šæ‹Ÿç¯å¢ƒä¸‹è¿è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š<pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">python gen_wts.py -w .&#x2F;runs&#x2F;train&#x2F;exp&#x2F;weights&#x2F;best.pt -o .&#x2F;best.wts -t detect<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>å‘½ä»¤è§£é‡Šï¼š<ul><li>-wï¼šæ˜¯æƒé‡æƒé‡å­˜æ”¾ä½ç½®</li><li>-oï¼šæ˜¯ç”Ÿæˆçš„wtsç±»å‹æƒé‡çš„åç§°ä»¥åŠå­˜æ”¾è·¯å¾„</li><li>-tï¼šæ˜¯æŒ‡å®šä½ çš„æ¨¡å‹ç±»å‹ï¼Œdetectè¡¨ç¤ºç›®æ ‡æ£€æµ‹ç½‘ç»œï¼Œclsè¡¨ç¤ºåˆ†ç±»ç½‘ç»œï¼Œsegè¡¨ç¤ºåˆ†å‰²ç½‘ç»œ<br>è¿è¡Œå®Œæ¯•åå³å¯å‘ç°åœ¨å½“å‰è·¯å¾„ä¸‹ä»¥åŠç”Ÿæˆäº†ä¸€ä¸ªbest.wtsæ–‡ä»¶</li></ul></li></ul><ol start="2"><li>å°†wtsæ ¼å¼æƒé‡è½¬æ¢ä¸ºtensorrtçš„engineæ ¼å¼<br>è¿™é‡Œéœ€è¦ä½¿ç”¨Githubä¸Šå¼€æºçš„ç›¸å…³å·¥ç¨‹æ–‡ä»¶ï¼Œä½¿ç”¨git cloneå°†å·¥ç¨‹å…‹éš†åˆ°ä»»æ„è·¯å¾„ä¸‹ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯æ¥ä¸‹æ¥çš„æ“ä½œéƒ½æ˜¯åœ¨Jetsonç³»ç»Ÿä¸Šè¿›è¡Œçš„ã€‚<ul><li>ä¸‹è½½ç›¸å…³æ–‡ä»¶ï¼Œä½¿ç”¨å‘½ä»¤ï¼ˆæ–¹æ³•åŒä¸Šï¼‰ï¼š  <pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">git clone https:&#x2F;&#x2F;github.com&#x2F;wang-xinyu&#x2F;tensorrtx<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li><li>è¯¥å·¥ç¨‹ç›®å½•å¦‚ä¸‹ï¼š <pre class="line-numbers language-c++" data-language="c++"><code class="language-c++"># â”œâ”€â”€ tensorrtx#     â””â”€â”€ yolov5#         â””â”€â”€ images#         â””â”€â”€ best.wts # å°†ä¸Šè¿°ç”Ÿæˆå¾—åˆ°çš„best.wtsæ–‡ä»¶æ”¾å…¥æ­¤è·¯å¾„#         â””â”€â”€ plugin # é‡Œé¢å­˜æ”¾çš„é€‚åˆyolov5æ¨¡å‹ç»“æ„ç›¸å…³çš„æ–‡ä»¶#         â””â”€â”€ src # é‡Œé¢æ˜¯æˆ‘ä»¬éœ€è¦ä¿®æ”¹åˆ°çš„æ¨¡å‹è¿è¡Œé…ç½®æ–‡ä»¶#             â””â”€â”€ config.h#                 â””â”€â”€ weights#                     â””â”€â”€ best.pt<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li>ä¿®æ”¹ç»†èŠ‚å¦‚ä¸‹ï¼š<ul><li>config.hï¼šå°†å…¶ä¸­çš„kNumClass = 80ä¿®æ”¹ä¸ºæˆ‘ä»¬æ¨¡å‹è®­ç»ƒä½¿ç”¨çš„ç±»åˆ«æ•°ï¼Œè¿™é‡Œæˆ‘ä¿®æ”¹çš„kNumClass = 2;</li></ul></li><li>ç„¶ååœ¨yolov5è·¯å¾„ä¸‹ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤å°†wtsæ ¼å¼æƒé‡æ–‡ä»¶è½¬æ¢ä¸ºengineæ ¼å¼æƒé‡æ–‡ä»¶ <pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">mkdir buildcd buildcmake ..makesudo .&#x2F;yolov5_det -s ..&#x2F;best.wts ..&#x2F;best.engine n<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>å‘½ä»¤è§£é‡Šï¼š<ul><li>å‰å››è¡Œå‘½ä»¤ï¼šæ˜¯ä½¿ç”¨cmakeç›¸å…³æŒ‡ä»¤å¯¹ç›¸å…³æ–‡ä»¶è¿›è¡Œç¼–è¯‘ï¼Œä»¥ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶yolov5_det</li><li>æœ€åä¸€è¡Œå‘½ä»¤ï¼š<ul><li>yolov5_detï¼šç›®æ ‡æ£€æµ‹çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œyolov5_clsä¸yolov5_segåŒç†ï¼›</li><li>-sï¼šåº”è¯¥æ˜¯ä¸€ç§æ¨¡å‹é€‰æ‹©ï¼ˆå³é€‰æ‹©è¿›è¡Œæ¨¡å‹è½¬æ¢æ¨¡å‹ï¼‰ï¼Œâ€¦/best.wtsè¡¨ç¤ºæˆ‘ä»¬å‰é¢æ“ä½œç”Ÿæˆçš„wtsæ ¼å¼æƒé‡æ–‡ä»¶ï¼Œå³æºæ–‡ä»¶ï¼›â€¦/best.engineæ˜¯ç›®æ ‡æ–‡ä»¶ï¼Œå³ç”Ÿæˆè½¬æ¢å¾—åˆ°çš„æ–‡ä»¶</li><li>nï¼šæ˜¯æˆ‘ä»¬yolov5æ¨¡å‹çš„ç±»å‹ï¼Œè¿™é‡Œç”±äºæˆ‘é€‰æ‹©ä½¿ç”¨çš„æ˜¯yolov5næ¨¡å‹ï¼Œæ•…ä¸ºnã€‚è¿™é‡Œæ‹“å±•ä¸€ä¸‹è‹¥æ˜¯yolov5mæ¨¡å‹ï¼Œåˆ™æ˜¯mï¼›yolov5læ¨¡å‹ï¼Œåˆ™æ˜¯lï¼›å…¶ä»–ç±»å‹åŒç†å³å¯ã€‚<br>æ³¨æ„ï¼šå¦‚æœè¿è¡Œå¤±è´¥ï¼Œè¯·ä¸¥æ ¼å¯¹ç…§æ˜¯å¦æŒ‰ç…§ä¸Šè¿°æ“ä½œå¯¹ç›¸å…³æ–‡ä»¶è¿›è¡Œä¿®æ”¹ã€‚</li></ul></li></ul></li><li>ä¹‹åä½¿ç”¨å¦‚ä¸‹å‘½ä»¤æ£€éªŒç”Ÿæˆçš„engineæ–‡ä»¶æ˜¯å¦æœ‰é—®é¢˜ï¼š <pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">sudo .&#x2F;yolov5_det -d ..&#x2F;best.engine ..&#x2F;samples<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>å‘½ä»¤è§£é‡Šï¼š<ul><li>-dï¼šè§£é‡ŠåŒä¸Šï¼Œæ˜¯ä¸€ç§æ¨¡å‹é€‰æ‹©ï¼Œå³è¿›è¡Œæµ‹è¯•</li><li>â€¦/best.engineï¼šæˆ‘ä»¬ç”Ÿæˆçš„engineæ ¼å¼æ–‡ä»¶è·¯å¾„</li><li>â€¦/samplesï¼šæˆ‘ä»¬è¦æ£€æµ‹çš„å›¾ç‰‡å­˜æ”¾è·¯å¾„ï¼Œè¿™é‡Œå¯è‡ªè¡Œåˆ›å»ºè¯¥æ–‡ä»¶å¤¹ï¼Œå¹¶å°†è‡ªå·±çš„å›¾ç‰‡æ”¾å…¥æ­¤æ–‡ä»¶å¤¹</li></ul></li><li>è¿è¡Œå®Œåï¼Œä¼šåœ¨å½“å‰è·¯å¾„ä¸‹å¾—åˆ°æ£€æµ‹åçš„å›¾ç‰‡ï¼Œå¯ä»¥è‡ªè¡Œè§‚å¯Ÿæ£€æµ‹æ¨¡å‹æ˜¯å¦æœ‰é—®é¢˜ã€‚</li><li>ç›¸å…³è·¯å¾„ï¼š <pre class="line-numbers language-c++" data-language="c++"><code class="language-c++"># â”œâ”€â”€ tensorrtx#     â””â”€â”€ yolov5#         â””â”€â”€ images#         â””â”€â”€ best.wts # å°†ä¸Šè¿°ç”Ÿæˆå¾—åˆ°çš„best.wtsæ–‡ä»¶æ”¾å…¥æ­¤è·¯å¾„#         â””â”€â”€ best.engine # ç”Ÿæˆçš„engineæ–‡ä»¶#         â””â”€â”€ samples#             â””â”€â”€ test1.jpg#             â””â”€â”€ test2.jpg#             â””â”€â”€ ...#         â””â”€â”€ plugin # é‡Œé¢å­˜æ”¾çš„é€‚åˆyolov5æ¨¡å‹ç»“æ„ç›¸å…³çš„æ–‡ä»¶#         â””â”€â”€ src # é‡Œé¢æ˜¯æˆ‘ä»¬éœ€è¦ä¿®æ”¹åˆ°çš„æ¨¡å‹è¿è¡Œé…ç½®æ–‡ä»¶#             â””â”€â”€ config.h#                 â””â”€â”€ weights#                     â””â”€â”€ best.pt#         â””â”€â”€ build # cmakeç›¸å…³è¯­å¥åå¾—åˆ°çš„æ–‡ä»¶#             â””â”€â”€ yolov5_det#             â””â”€â”€ libmyplugins.so<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ul></li></ol><h4 id="é€‰æ‹©æ¡†æ¶â€”â€”DeepStream">é€‰æ‹©æ¡†æ¶â€”â€”DeepStream</h4><ol><li>å®‰è£…Deepstream5.x<ul><li>é™„ä¸Šä¸‹è½½åœ°å€ï¼š<a href="https://developer.nvidia.com/deepstream-getting-started">https://developer.nvidia.com/deepstream-getting-started</a></li><li>è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯å¿…é¡»å®‰è£…Deepstream5.xç‰ˆæœ¬ï¼Œæœ€å¥½æ˜¯5.0ï¼Œä¸ç„¶ä»¥ä¸‹æ“ä½œå¯èƒ½æ— æ•ˆï¼Œ</li></ul></li><li>ä¸‹è½½ç›¸å…³æºæ–‡ä»¶<br>ä»Githubä¸Šå…‹éš†ä»–äººå¼€æºçš„å·¥ç¨‹æ–‡ä»¶ï¼Œä½¿ç”¨å‘½ä»¤ï¼ˆæ–¹æ³•åŒä¸Šï¼‰ï¼š <pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">git clone git@github.com:DanaHan&#x2F;Yolov5-in-Deepstream-5.0.git<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>è¯¥å·¥ç¨‹ç›®å½•å¦‚ä¸‹ï¼ˆè¿™é‡Œåªç»™å‡ºè¦ä¿®æ”¹çš„æ–‡ä»¶ï¼‰ï¼š <pre class="line-numbers language-c++" data-language="c++"><code class="language-c++"># â”œâ”€â”€ Yolov5-in-Deepstream-5.0#     â””â”€â”€ Deepstream5.0#         â””â”€â”€ includes#         â””â”€â”€ nvdsinfer_custom_impl_Yolo#             â””â”€â”€ nvdsparsebbox_Yolo.cpp#             â””â”€â”€ Makefile#         â””â”€â”€ deepstream_app_config_yoloV5.txt<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li>ä¿®æ”¹ç»†èŠ‚ï¼š<ul><li>è¿›å…¥nvdsparsebbox_Yolo.cppæ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼Œç»†èŠ‚è§æ³¨é‡Šï¼š<pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">...#include &lt;cstdio&gt;#include &quot;serial&#x2F;serial.h&quot;#include &lt;vector&gt;...static bool NvDsInferParseYoloV5(    std::vector&lt;NvDsInferLayerInfo&gt; const&amp; outputLayersInfo,    NvDsInferNetworkInfo const&amp; networkInfo,    NvDsInferParseDetectionParams const&amp; detectionParams,    std::vector&lt;NvDsInferParseObjectInfo&gt;&amp; objectList)&#123;        serial::Serial my_serial(&quot;&#x2F;dev&#x2F;ttyTHS1&quot;, 9600, serial::Timeout::simpleTimeout(50)); &#x2F;&#x2F; è®¾ç½®ä¸²å£    &#x2F;*if(my_serial.isOpen())&#123;                                                           &#x2F;&#x2F; æµ‹è¯•ä¸²å£æ˜¯å¦æˆåŠŸæ‰“å¼€        std::cout &lt;&lt; &quot;the location:    X:&quot; &lt;&lt; std::endl;    &#125;*&#x2F;    std::vector&lt;Detection&gt; res;    nms(res, (float*)(outputLayersInfo[0].buffer), CONF_THRESH, NMS_THRESH);    &#x2F;&#x2F;std::cout&lt;&lt;&quot;Nms done sucessfully----&quot;&lt;&lt;std::endl;    NvDsInferParseObjectInfo globalbbox;                                                &#x2F;&#x2F; è®¾ç½®ç›®æ ‡æ£€æµ‹åŒºåŸŸ    globalbbox.classId &#x3D; 0;    globalbbox.left    &#x3D; static_cast&lt;unsigned int&gt;(160);    globalbbox.top     &#x3D; static_cast&lt;unsigned int&gt;(120);    globalbbox.width   &#x3D; static_cast&lt;unsigned int&gt;(320);    globalbbox.height  &#x3D; static_cast&lt;unsigned int&gt;(240);    globalbbox.detectionConfidence &#x3D; 0.9;    objectList.push_back(globalbbox);                                                   &#x2F;&#x2F; å°†ç›®æ ‡æ£€æµ‹åŒºåŸŸå½“ä½œç›®æ ‡ï¼Œä»¥åœ¨è§†é¢‘ä¸­å¾—åˆ°æ˜¾ç¤º    std::string output &#x3D; &quot;A&quot;;                                                           &#x2F;&#x2F; è®¾ç½®æ ‡å¿—ä½    unsigned int x &#x3D; 100;                                                               &#x2F;&#x2F; è®¾ç½®åˆå§‹ç›®æ ‡çš„ä¸­å¿ƒ    unsigned int y &#x3D; 100;    unsigned int x_temp &#x3D; 0;                                                            &#x2F;&#x2F; è®¾ç½®æš‚å­˜å˜é‡    unsigned int y_temp &#x3D; 0;    double confidence_max &#x3D; 0;                                                          &#x2F;&#x2F; æŒ‰ç…§ç½®ä¿¡åº¦è¿›è¡Œä¼˜å…ˆçº§é€‰æ‹©    for(auto&amp; r : res) &#123;      NvDsInferParseObjectInfo oinfo;              oinfo.classId &#x3D; r.class_id;            if(oinfo.classId !&#x3D; 0) continue;      oinfo.left    &#x3D; static_cast&lt;unsigned int&gt;(r.bbox[0]-r.bbox[2]*0.5f);      oinfo.top     &#x3D; static_cast&lt;unsigned int&gt;(r.bbox[1]-r.bbox[3]*0.5f);      oinfo.width   &#x3D; static_cast&lt;unsigned int&gt;(r.bbox[2]);      oinfo.height  &#x3D; static_cast&lt;unsigned int&gt;(r.bbox[3]);      oinfo.detectionConfidence &#x3D; r.conf;      x_temp &#x3D; static_cast&lt;unsigned int&gt;(oinfo.left + oinfo.width*0.5f);                &#x2F;&#x2F; è®¡ç®—ç›®æ ‡çš„ä¸­å¿ƒx,y      y_temp &#x3D; static_cast&lt;unsigned int&gt;(oinfo.top + oinfo.height*0.5f);      if(x_temp&gt;160 &amp;&amp; x_temp&lt;480 &amp;&amp; y_temp&gt;120 &amp;&amp; y_temp&lt; 360 &amp;&amp; r.conf &gt; confidence_max)&#123;  &#x2F;&#x2F; åˆ¤æ–­ç›®æ ‡ä¸­å¿ƒæ˜¯å¦è½å…¥æ£€æµ‹åŒºåŸŸ          x &#x3D; x_temp;y &#x3D; y_temp; confidence_max &#x3D; r.conf;      &#125;      objectList.push_back(oinfo);            &#125;    output +&#x3D; std::to_string(x);                                                        &#x2F;&#x2F; å°†ä¸²å£è¦å‘é€çš„ä½ç½®ä¿¡æ¯è½¬æ¢ä¸ºåˆé€‚æ ¼å¼    output +&#x3D; std::to_string(y);    output +&#x3D; &#39;B&#39;;                                                                      &#x2F;&#x2F; è®¾ç½®åœæ­¢ä½    std::vector&lt;uint8_t&gt; data(output.begin(), output.end());                            &#x2F;&#x2F; å¯¹æ•°æ®è¿›è¡Œç¼–ç ï¼Œä»¥é…åˆä¸²å£å‘é€ä¿¡æ¯    &#x2F;&#x2F; std::cout &lt;&lt; data.size() &lt;&lt; std::endl;    my_serial.write(data.data(), data.size());                                          &#x2F;&#x2F; ä¸²å£å‘é€åæ ‡ä¿¡æ¯    std::cout &lt;&lt; &quot;the location:    X:&quot; &lt;&lt; x &lt;&lt;&quot;,   Y:&quot; &lt;&lt; y  &lt;&lt; &quot;,   conf:&quot; &lt;&lt; confidence_max &lt;&lt; &quot;,   link:&quot; &lt;&lt; data.data() &lt;&lt; std::endl;  &#x2F;&#x2F; dæ‰“å°å½“å‰ä¸²å£å‘é€çš„åæ ‡ä¿¡æ¯ï¼Œå®é™…ä¸­å¯ä»¥å°†æ­¤è¡Œæ³¨é‡Šæ‰ï¼Œå› ä¸ºprintæ“ä½œä¼šå½±å“ç¨‹åºè¿è¡Œé€Ÿåº¦    return true;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li>å°†ä¸Šè¿°æ¨¡å‹æ ¼å¼è½¬æ¢è¿‡ç¨‹ä¸­ç”Ÿæˆçš„best.engineä¸libmyplugins.soæ–‡ä»¶å¤åˆ¶åˆ°Deepstream5.0è·¯å¾„ä¸‹</li><li>ä¿®æ”¹deepstream_app_config_yoloV5.txtæ–‡ä»¶ï¼Œä¿®æ”¹ç»†èŠ‚ä»¥åŠå…·ä½“æ³¨é‡Šå¦‚ä¸‹ï¼š<pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">...[source0]enable&#x3D;1#Type - 1&#x3D;CameraV4L2 2&#x3D;URI 3&#x3D;MultiURItype&#x3D;1   # cameracamera-width&#x3D;640 # ç›¸æœºè·å–è§†é¢‘çš„å®½camera-height&#x3D;480# ç›¸æœºè·å–è§†é¢‘çš„é«˜camera-fps-n&#x3D;30  # ç›¸æœºè·å–è§†é¢‘çš„å¸§ç‡åˆ†å­ä¸º30camera-fps-d&#x3D;1   # ç›¸æœºè·å–è§†é¢‘çš„å¸§ç‡åˆ†æ¯ä¸º1ï¼Œnä¸dé…åˆï¼Œå³30å¸§#camera-v412-dev-node&#x3D;0#uri&#x3D;file:&#x2F;opt&#x2F;nvidia&#x2F;deepstream&#x2F;deepstream-5.0&#x2F;samples&#x2F;streams&#x2F;sample_1080p_h264.mp4#uri&#x3D;file:&#x2F;home&#x2F;nvidia&#x2F;Documents&#x2F;5-Materials&#x2F;Videos&#x2F;0825.avinum-sources&#x3D;1    # è®¾ç½®è¾“å…¥æºæ•°é‡ï¼Œè¿™é‡Œæ˜¯1ä¸ªgpu-id&#x3D;0         # è®¾ç½®ä½¿ç”¨çš„GPU IDï¼Œè¿™é‡Œæ˜¯0å·GPU# (0): memtype_device   - Memory type Device# (1): memtype_pinned   - Memory type Host Pinned# (2): memtype_unified  - Memory type Unifiedcudadec-memtype&#x3D;0  # è®¾ç½®CUDAè§£ç å™¨ä½¿ç”¨çš„å†…å­˜ç±»å‹ï¼Œè¿™é‡Œæ˜¯Deviceå†…å­˜...# è¿™é‡Œæ˜¯é…ç½®ç”Ÿæˆè§†é¢‘æµ[streammux] ...width&#x3D;640height&#x3D;480......[primary-gie]enable&#x3D;1gpu-id&#x3D;0model-engine-file&#x3D;best.engine # ç‰©ä½“æ£€æµ‹æ¨¡å‹å¼•æ“æ–‡ä»¶labelfile-path&#x3D;labels.txt     # æ ‡ç­¾æ–‡ä»¶è·¯å¾„,åŒ…å«ç±»åï¼Œè¿™é‡Œéœ€è¦è‡ªå·±åˆ›å»ºä¸€ä¸ªlabels.txtæ–‡ä»¶#batch-size&#x3D;1#Required by the app for OSD, not a plugin propertybbox-border-color0&#x3D;1;0;0;1  # è¾¹ç•Œæ¡†è¾¹æ¡†é¢œè‰²bbox-border-color1&#x3D;0;1;1;1bbox-border-color2&#x3D;0;0;1;1bbox-border-color3&#x3D;0;1;0;1interval&#x3D;0  # æ¨ç†é—´éš”,å•ä½æ¯«ç§’gie-unique-id&#x3D;1nvbuf-memory-type&#x3D;0config-file&#x3D;config_infer_primary_yoloV5.txt  # åŒ…å«æ›´å¤šè®¾ç½®çš„é…ç½®æ–‡ä»¶[tracker]enable&#x3D;0tracker-width&#x3D;512tracker-height&#x3D;320ll-lib-file&#x3D;&#x2F;opt&#x2F;nvidia&#x2F;deepstream&#x2F;deepstream-5.0&#x2F;lib&#x2F;libnvds_mot_klt.so  # æ ¹æ®è‡ªå·±çš„libnvds_mot_klt.soå­˜æ”¾è·¯å¾„è¿›è¡Œæ›´æ”¹ï¼Œä¸€èˆ¬è€Œè¨€ä¸éœ€è¦ä¿®æ”¹æ­¤é¡¹ã€‚å¦‚æœæ˜¯Deepstream5.1ï¼Œå¯èƒ½éœ€è¦ä¿®æ”¹ä¸º&#x2F;opt&#x2F;nvidia&#x2F;deepstream&#x2F;deepstream-5.1&#x2F;lib&#x2F;libnvds_mot_klt.so...<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li>åœ¨Deepstream5.0è·¯å¾„ä¸‹åˆ›å»ºä¸€ä¸ªlabels.txtæ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š<pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">hole<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>è§£é‡Šï¼šä¸€ä¸ªç›®æ ‡ä¸€è¡Œï¼Œå³è¡¨ç¤ºç´¢å¼•å’Œå†…å®¹</li><li>ä¿®æ”¹Makefileæ–‡ä»¶å†…å®¹ï¼Œç»†èŠ‚ä»¥åŠæ³¨é‡Šå¦‚ä¸‹ï¼š<pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">CUDA_VER?&#x3D;10.2ifeq ($(CUDA_VER),)  $(error &quot;CUDA_VER is not set&quot;)endifCC:&#x3D; g++NVCC:&#x3D;&#x2F;usr&#x2F;local&#x2F;cuda-$(CUDA_VER)&#x2F;bin&#x2F;nvccCFLAGS:&#x3D; -Wall -std&#x3D;c++11 -shared -fPIC -Wno-error&#x3D;deprecated-declarationsCFLAGS+&#x3D; -I..&#x2F;includes -I&#x2F;usr&#x2F;local&#x2F;cuda-$(CUDA_VER)&#x2F;include -I&#x2F;opt&#x2F;ros&#x2F;melodic&#x2F;include # æ–°å¢çš„ï¼Œä»¥æˆåŠŸåœ¨å¾…ç¼–è¯‘çš„cppæ–‡ä»¶ä¸­å¼•å…¥&lt;serial&#x2F;serial.h&gt;å¤´æ–‡ä»¶LIBS:&#x3D; -lnvinfer_plugin -lnvinfer -lnvparsers -L&#x2F;usr&#x2F;local&#x2F;cuda-$(CUDA_VER)&#x2F;lib64 -lcudart -lcublas -lstdc++fs -L&#x2F;opt&#x2F;ros&#x2F;melodic&#x2F;lib -lserial  # æ–°å¢çš„ï¼Œé“¾æ¥åº“æ–‡ä»¶&#x2F;opt&#x2F;ros&#x2F;melodic&#x2F;lib&#x2F;libserial.soï¼Œä»¥å®ç°ä¸²å£é€šä¿¡ã€‚LFLAGS:&#x3D; -shared -Wl,--start-group $(LIBS) -Wl,--end-groupINCS:&#x3D; $(wildcard *.h) SRCFILES:&#x3D; nvdsinfer_yolo_engine.cpp \          nvdsparsebbox_Yolo.cpp   \          trt_utils.cpp              \          #  yolo.cpp              \  # æ³¨é‡Šæ‰è¿™ä¸¤è¡Œï¼Œå› ä¸ºä½¿ç”¨ä¸åˆ°ï¼Œå¹¶ä¸”ä½¿ç”¨çš„è¯ä¼šå¯¼è‡´æ— æ³•é¡ºåˆ©é€šè¿‡ç¼–è¯‘ã€‚          #  yoloPlugins.cpp          # æ³¨é‡Šæ‰è¿™ä¸¤è¡ŒTARGET_LIB:&#x3D; libnvdsinfer_custom_impl_Yolo.so#TARGET_LIB:&#x3D; libnvdsinfer_custom_impl_Yolo.soTARGET_OBJS:&#x3D; $(SRCFILES:.cpp&#x3D;.o)TARGET_OBJS:&#x3D; $(TARGET_OBJS:.cu&#x3D;.o)all: $(TARGET_LIB)%.o: %.cpp $(INCS) Makefile  $(CC) -c -o $@ $(CFLAGS) $&lt;%.o: %.cu $(INCS) Makefile  $(NVCC) -c -o $@ --compiler-options &#39;-fPIC&#39; $&lt;$(TARGET_LIB) : $(TARGET_OBJS)  $(CC) -o $@  $(TARGET_OBJS) $(LFLAGS)clean:  rm -rf $(TARGET_LIB)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>ä¸Šè¿°Makefileæ–‡ä»¶çš„ä¿®æ”¹å…·ä½“è§£é‡Šå¯ä»¥å‚è€ƒæˆ‘çš„å¦ä¸€ç¯‡åšå®¢ï¼Œé‡Œé¢è¯¦ç»†è®°å½•äº†ç›¸å…³å†…å®¹ï¼š<a href="https://sprli.github.io/2023/05/26/Cmake_Study/">https://sprli.github.io/2023/05/26/Cmake_Study/</a></li></ul></li></ol><h4 id="è¿è¡ŒåŠä½¿ç”¨">è¿è¡ŒåŠä½¿ç”¨</h4><h3 id="å¦‚ä½•å®ç°ç¨‹åºè‡ªå¯åŠ¨">å¦‚ä½•å®ç°ç¨‹åºè‡ªå¯åŠ¨</h3>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;è¿™ç¯‡åšå®¢ç”¨æ¥è®°å½•å‚åŠ æµ·èµ›C2è¿‡ç¨‹ä¸­ï¼Œå¦‚ä½•å®ç°åœ¨Jetson Nanoä¸Šéƒ¨ç½²ç›®æ ‡æ£€æµ‹ç®—æ³•ä»¥åŠä½¿ç”¨ä¸²å£é€šä¿¡çš„æ–¹æ³•ã€‚&lt;/p&gt;
&lt;h3 id=&quot;æ•°æ®æ ‡æ³¨ä¸æ¨¡å‹è®­ç»ƒ&quot;&gt;æ•°æ®æ ‡æ³¨ä¸æ¨¡å‹è®­ç»ƒ&lt;/h3&gt;
&lt;h4 id=&quot;YoloV5çš„ä½¿ç”¨ä¸ç®€å•è®²è§£&quot;&gt;YoloV5çš„ä½¿ç”¨ä¸ç®€å•è®²è§£&lt;/h4&gt;</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>cmakeå­¦ä¹ è®°å½•</title>
    <link href="https://sprli.github.io/2023/05/26/Cmake_Study/"/>
    <id>https://sprli.github.io/2023/05/26/Cmake_Study/</id>
    <published>2023-05-26T03:48:14.194Z</published>
    <updated>2023-07-08T11:28:08.751Z</updated>
    
    <content type="html"><![CDATA[<h2 id="é—®é¢˜èƒŒæ™¯">é—®é¢˜èƒŒæ™¯</h2><p>è¿™ä¸ªé—®é¢˜æ˜¯æˆ‘åœ¨åšæµ·èµ›C2æ¯”èµ›ç¼–å†™éƒ¨ç½²è‡ªåŠ¨æ‰“é¶ç®—æ³•é‡åˆ°çš„ã€‚å…ˆç®€å•å™è¿°ä¸€ä¸‹èµ·å› ï¼Œç”±äºæˆ‘ä»¬C2é˜Ÿä¼ä½¿ç”¨çš„æ˜¯Jetson Nanoæ¥è¯†åˆ«é¶å¿ƒï¼Œè¿›è€Œå®ç°è‡ªåŠ¨æ‰“é¶åŠŸèƒ½ï¼Œäºæ˜¯ç®—æ³•è¯†åˆ«è¿™æ–¹é¢å°±ç”±æˆ‘æ¥è¿›å±•ã€‚åœ¨ç½‘ä¸Šå‚è€ƒäº†ä¸€äº›éƒ¨ç½²æ–¹æ¡ˆã€‚æœ€ç»ˆé€‰æ‹©äº†ä½¿ç”¨Deepstreamæ¶æ„è¿è¡Œyolov5nçš„trtæ¨¡å‹è¿›è¡Œè¯†åˆ«æ£€æµ‹ã€‚ä½†æ˜¯ç”±äºæˆ‘ä»¬çš„éœ€æ±‚ä¸ä»…æ˜¯æ£€æµ‹åˆ°é¶å¿ƒï¼Œè¿˜è¦å°†æ£€æµ‹åˆ°çš„é¶å¿ƒçš„ä½ç½®ä¼ é€’ç»™ä¸‹ä½æœºstm32ï¼Œå› æ­¤æˆ‘éœ€è¦åœ¨è¯¥æ¶æ„ä¸­åŠ å…¥ä¸²å£é€šä¿¡æ¨¡å—ï¼Œå®ç°è¯¥åŠŸèƒ½ã€‚ç”±äºDeepstreamåœ¨å›½å†…çš„ç›¸å…³èµ„æ–™å¾ˆå°‘ï¼Œæ•…éœ€è¦è‡ªå·±å»äº†è§£å¹¶å®ç°æ·»åŠ è¯¥æ¨¡å—åˆ°è¿™ä¸ªæ¡†æ¶ä¸­ã€‚è€Œä¸”å…¶ä»£ç åŸºæœ¬éƒ½æ˜¯C++ä»£ç ï¼Œè¿‡ç¨‹ä¸­è¦ç”¨åˆ°cmakeç­‰ç¼–è¯‘å·¥å…·ï¼Œæ•…è€Œæ¥è§¦åˆ°äº†cmakeç›¸å…³æ–‡ä»¶çš„ç¼–å†™ä¸ä½¿ç”¨ï¼Œå¹¶å†™ä¸‹è¯¥ç¯‡åšå®¢å¯¹å…¶è¿›è¡Œè®°å½•ã€‚</p><h2 id="ä¸€ã€cmakeæ˜¯ä»€ä¹ˆ">ä¸€ã€cmakeæ˜¯ä»€ä¹ˆ</h2><p>CMakeæ˜¯ä¸€ä¸ªè·¨å¹³å°çš„ç¼–è¯‘(Build)å·¥å…·,å¯ä»¥ç”¨ç®€å•çš„è¯­å¥æ¥æè¿°æ‰€æœ‰å¹³å°çš„ç¼–è¯‘è¿‡ç¨‹ã€‚<br>CMakeèƒ½å¤Ÿè¾“å‡ºå„ç§å„æ ·çš„makefileæˆ–è€…projectæ–‡ä»¶ï¼Œèƒ½æµ‹è¯•ç¼–è¯‘å™¨æ‰€æ”¯æŒçš„C++ç‰¹æ€§ã€‚<br>å‡å¦‚æˆ‘ä»¬æœ‰ä¸€ä¸ªæ·±åº¦å­¦ä¹ æ¡†æ¶çš„éƒ¨åˆ†å·¥ç¨‹åˆ—è¡¨ï¼Œé‡Œé¢æœ‰è¶…è¿‡40ä¸ªäº’ç›¸è°ƒç”¨çš„å·¥ç¨‹å…±åŒç»„æˆï¼Œä¸€äº›ç”¨äºç”Ÿæˆåº“æ–‡ä»¶ï¼Œä¸€äº›ç”¨äºå®ç°é€»è¾‘åŠŸèƒ½ã€‚ä»–ä»¬ä¹‹é—´çš„è°ƒç”¨å…³ç³»å¤æ‚è€Œä¸¥æ ¼ï¼Œå¦‚æœæˆ‘æƒ³åœ¨è¿™æ ·å¤æ‚çš„æ¡†æ¶ä¸‹è¿›è¡ŒäºŒæ¬¡å¼€å‘ï¼Œæ˜¾ç„¶åªæ‹¥æœ‰å®ƒçš„æºç æ˜¯è¿œè¿œä¸å¤Ÿçš„ï¼Œè¿˜éœ€è¦æ¸…æ¥šçš„æ˜ç™½è¿™å‡ åä¸ªé¡¹ç›®ä¹‹é—´çš„å¤æ‚å…³ç³»ï¼Œåœ¨æ²¡æœ‰åŸä½œè€…çš„å¸®åŠ©ä¸‹è¿›è¡Œè¿™é¡¹å·¥ä½œå‡ ä¹æ˜¯ä¸å¯èƒ½çš„ã€‚å³ä½¿åŸä½œè€…ç»™å‡ºäº†ç›¸å…³çš„ç»“æ„æ–‡æ¡£ï¼Œå¯¹æ–°æ‰‹æ¥è¯´å»ºç«‹å·¥ç¨‹çš„è¿‡ç¨‹ä¾æ—§æ˜¯æ¼«é•¿è€Œè‰°è¾›çš„ï¼Œå› æ­¤CMakeçš„ä½œç”¨å°±å‡¸æ˜¾å‡ºæ¥äº†ã€‚åŸä½œè€…åªéœ€è¦ç”Ÿæˆä¸€ä»½CMakeLists.txtæ–‡æ¡£ï¼Œæ¡†æ¶çš„ä½¿ç”¨è€…ä»¬åªéœ€è¦åœ¨ä¸‹è½½æºç çš„åŒæ—¶ä¸‹è½½ä½œè€…æä¾›çš„CMakeLists.txtï¼Œå°±å¯ä»¥åˆ©ç”¨CMakeï¼Œåœ¨â€œåŸä½œè€…çš„å¸®åŠ©ä¸‹â€è¿›è¡Œå·¥ç¨‹çš„æ­å»ºã€‚</p><h2 id="äºŒã€cmakeçš„ä½¿ç”¨">äºŒã€cmakeçš„ä½¿ç”¨</h2><h3 id="2-1-CMakeLists-txtçš„è¯­æ³•">2.1 CMakeLists.txtçš„è¯­æ³•</h3><p>å…ˆé™„ä¸Šç›¸å…³ä»£ç </p><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">cmake_minimum_required(VERSION 3.10)project(yolov5)add_definitions(-std&#x3D;c++11)add_definitions(-DAPI_EXPORTS)option(CUDA_USE_STATIC_CUDA_RUNTIME OFF)set(CMAKE_CXX_STANDARD 11)set(CMAKE_BUILD_TYPE Debug)# TODO(Call for PR): make cmake compatible with Windowsset(CMAKE_CUDA_COMPILER &#x2F;usr&#x2F;local&#x2F;cuda&#x2F;bin&#x2F;nvcc)enable_language(CUDA)include_directories(&#x2F;opt&#x2F;ros&#x2F;melodic&#x2F;include)# include and link dirs of cuda and tensorrt, you need adapt them if yours are different# cudainclude_directories(&#x2F;usr&#x2F;local&#x2F;cuda&#x2F;include)link_directories(&#x2F;usr&#x2F;local&#x2F;cuda&#x2F;lib64)# tensorrt# TODO(Call for PR): make TRT path configurable from command lineinclude_directories(&#x2F;home&#x2F;nvidia&#x2F;TensorRT-8.2.5.1&#x2F;include&#x2F;)link_directories(&#x2F;home&#x2F;nvidia&#x2F;TensorRT-8.2.5.1&#x2F;lib&#x2F;)include_directories($&#123;PROJECT_SOURCE_DIR&#125;&#x2F;src&#x2F;)include_directories($&#123;PROJECT_SOURCE_DIR&#125;&#x2F;plugin&#x2F;)file(GLOB_RECURSE SRCS $&#123;PROJECT_SOURCE_DIR&#125;&#x2F;src&#x2F;*.cpp $&#123;PROJECT_SOURCE_DIR&#125;&#x2F;src&#x2F;*.cu)file(GLOB_RECURSE PLUGIN_SRCS $&#123;PROJECT_SOURCE_DIR&#125;&#x2F;plugin&#x2F;*.cu)add_library(myplugins SHARED $&#123;PLUGIN_SRCS&#125;)target_link_libraries(myplugins nvinfer cudart)find_package(OpenCV)include_directories($&#123;OpenCV_INCLUDE_DIRS&#125;)add_executable(yolov5_det yolov5_det.cpp $&#123;SRCS&#125;)target_link_libraries(yolov5_det nvinfer)target_link_libraries(yolov5_det cudart)target_link_libraries(yolov5_det myplugins)target_link_libraries(yolov5_det $&#123;OpenCV_LIBS&#125;)target_link_libraries(yolov5_det &#x2F;opt&#x2F;ros&#x2F;melodic&#x2F;lib&#x2F;libserial.so)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç›¸å…³è§£é‡Šï¼š<br>ç”±äºæˆ‘ä¹Ÿæ˜¯æµ…æµ…åœ°äº†è§£ä½¿ç”¨ï¼Œå°±åªä»‹ç»æˆ‘ç†è§£çš„å‡ ä¸ªå‡½æ•°å§</p><ul><li>project(yolov5) è¡¨ç¤ºå®šä¹‰ä¸€ä¸ªåä¸ºyolov5çš„å·¥ç¨‹</li><li>include_directories(/opt/ros/melodic/include) å¯ä»¥è¿™æ ·æ¥ç†è§£ï¼ŒåŠ å…¥æˆ‘ä»¬éœ€è¦å¼•å…¥ä¸€ä¸ªå¤´æ–‡ä»¶&lt;serial/serial.h&gt;ï¼Œä½†æ˜¯è¿™ä¸ªå¤´æ–‡ä»¶æ˜¯åœ¨è·¯å¾„/opt/ros/melodic/includeè·¯å¾„ä¸‹ï¼Œè€Œä½ çš„æ–‡ä»¶è·¯å¾„å´ä¸åœ¨è¯¥è·¯å¾„ä¸‹ï¼Œå¦‚æœä½¿ç”¨#include &quot;/opt/ros/melodic/include/serial/serial.h&quot;çš„è¯æœªå…å¤ªè¿‡éº»çƒ¦äº†ï¼Œä½†æ˜¯å¦‚æœåœ¨CmakeList.txtä¸­åŠ å…¥include_directories(/opt/ros/melodic/include)ä¸€å¥ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨#include &quot;serial/serial.h&quot;ç®€å•åœ°å¼•å…¥è¯¥å¤´æ–‡ä»¶äº†ã€‚</li><li>file(GLOB_RECURSE PLUGIN_SRCS ${PROJECT_SOURCE_DIR}/plugin/*.cu) è¡¨ç¤ºåœ¨é¡¹ç›®æºä»£ç ç›®å½•ä¸­çš„pluginå­ç›®å½•ä¸­æŸ¥æ‰¾æ‰€æœ‰æ‰©å±•åä¸º.cuçš„CUDAæºæ–‡ä»¶ï¼Œå¹¶å°†å®ƒä»¬å­˜å‚¨åœ¨PLUGIN_SRCSå˜é‡ä¸­</li><li>add_library(myplugins SHARED ${PLUGIN_SRCS}) è¡¨ç¤ºåˆ›å»ºä¸€ä¸ªåä¸ºmypluginsçš„å…±äº«åº“ï¼Œå¹¶å°†PLUGIN_SRCSå˜é‡ä¸­çš„æ‰€æœ‰CUDAæºæ–‡ä»¶é“¾æ¥åˆ°è¯¥åº“ä¸­ã€‚</li><li>link_directories(/home/nvidia/TensorRT-8.2.5.1/lib/) æ˜¯æŒ‡å°†TensorRTåº“çš„è·¯å¾„æ·»åŠ åˆ°ç¼–è¯‘å™¨çš„åº“æœç´¢è·¯å¾„ä¸­ï¼Œä»¥ä¾¿ç¼–è¯‘å™¨å¯ä»¥æ‰¾åˆ°æ‰€éœ€çš„åº“æ–‡ä»¶</li><li>add_executable(yolov5_det yolov5_det.cpp ${SRCS}) è¡¨ç¤ºåœ¨å½“å‰è·¯å¾„ä¸‹ç¼–è¯‘ä¸€ä¸ªåä¸ºyolov5_detçš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶çš„æºä»£ç ä½äºyolov5_det.cppæ–‡ä»¶ä¸­ï¼Œè€Œå…¶ä»–æºæ–‡ä»¶ä½äºSRCSå˜é‡ä¸­ã€‚</li><li>target_link_libraries(yolov5_det /opt/ros/melodic/lib/libserial.so) è¡¨ç¤ºå°†åä¸ºyolov5_detçš„ç›®æ ‡æ–‡ä»¶ä¸åä¸ºlibserial.soçš„åº“æ–‡ä»¶é“¾æ¥ï¼Œä»¥ä¾¿åœ¨è¿è¡Œæ—¶å¯ä»¥ä½¿ç”¨è¯¥åº“æ–‡ä»¶ä¸­å®šä¹‰çš„å‡½æ•°å’Œå˜é‡ã€‚</li></ul><p>æ˜ç™½äº†ä¸Šé¢è¿™äº›è¯­å¥çš„åŸºæœ¬ç”¨æ³•ï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨æºæ–‡ä»¶çš„åŸºç¡€ä¸ŠåŠ ä¸Šæˆ‘ä»¬çš„ä»£ç ï¼Œå®ç°æˆ‘ä»¬æƒ³è¦çš„åŠŸèƒ½äº†ã€‚</p><h3 id="2-2-Makefileç›¸å…³è¯­æ³•">2.2 Makefileç›¸å…³è¯­æ³•</h3><p>æœ‰æ—¶å€™æˆ‘ä»¬å¾—åˆ°çš„æ–‡ä»¶ä¸­æ²¡æœ‰CMakeList.txtæ–‡ä»¶ï¼Œä½†æ˜¯ä¼šæœ‰Makefileæ–‡ä»¶ï¼Œè¿™æ—¶å¦‚æœæˆ‘ä»¬æƒ³ä¿®æ”¹ä¸€ä¸‹ä»£ç ä»¥å¼•å…¥ä¸€äº›å…¶ä»–åŠŸèƒ½ï¼Œä¹Ÿä¸æ˜¯ä¸å¯èƒ½ï¼Œå¯ä»¥è¯•ç€ä¿®æ”¹Makefileæ–‡ä»¶ï¼Œå°è¯•å®ç°æˆ‘ä»¬æƒ³è¦çš„åŠŸèƒ½ã€‚<br>å…ˆé™„ä¸Šç›¸å…³ä»£ç </p><pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">CUDA_VER?&#x3D;ifeq ($(CUDA_VER),)$(error &quot;CUDA_VER is not set&quot;)endifOPENCV?&#x3D;ifeq ($(OPENCV),)OPENCV&#x3D;0endifCC:&#x3D; g++NVCC:&#x3D;&#x2F;usr&#x2F;local&#x2F;cuda-$(CUDA_VER)&#x2F;bin&#x2F;nvccCFLAGS:&#x3D; -Wall -std&#x3D;c++11 -shared -fPIC -Wno-error&#x3D;deprecated-declarationsCFLAGS+&#x3D; -I&#x2F;opt&#x2F;nvidia&#x2F;deepstream&#x2F;deepstream&#x2F;sources&#x2F;includes -I&#x2F;usr&#x2F;local&#x2F;cuda-$(CUDA_VER)&#x2F;includeifeq ($(OPENCV), 1)COMMON&#x3D; -DOPENCVCFLAGS+&#x3D; $(shell pkg-config --cflags opencv4 2&gt; &#x2F;dev&#x2F;null || pkg-config --cflags opencv)LIBS+&#x3D; $(shell pkg-config --libs opencv4 2&gt; &#x2F;dev&#x2F;null || pkg-config --libs opencv)endifCUFLAGS:&#x3D; -I&#x2F;opt&#x2F;nvidia&#x2F;deepstream&#x2F;deepstream&#x2F;sources&#x2F;includes -I&#x2F;usr&#x2F;local&#x2F;cuda-$(CUDA_VER)&#x2F;includeLIBS+&#x3D; -lnvinfer_plugin -lnvinfer -lnvparsers -L&#x2F;usr&#x2F;local&#x2F;cuda-$(CUDA_VER)&#x2F;lib64 -lcudart -lcublas -lstdc++fsLFLAGS:&#x3D; -shared -Wl,--start-group $(LIBS) -Wl,--end-groupINCS:&#x3D; $(wildcard *.h)SRCFILES:&#x3D; $(filter-out calibrator.cpp, $(wildcard *.cpp))ifeq ($(OPENCV), 1)SRCFILES+&#x3D; calibrator.cppendifSRCFILES+&#x3D; $(wildcard layers&#x2F;*.cpp)SRCFILES+&#x3D; $(wildcard *.cu)TARGET_LIB:&#x3D; libnvdsinfer_custom_impl_Yolo.soTARGET_OBJS:&#x3D; $(SRCFILES:.cpp&#x3D;.o)TARGET_OBJS:&#x3D; $(TARGET_OBJS:.cu&#x3D;.o)all: $(TARGET_LIB)%.o: %.cpp $(INCS) Makefile$(CC) -c $(COMMON) -o $@ $(CFLAGS) $&lt;%.o: %.cu $(INCS) Makefile$(NVCC) -c -o $@ --compiler-options &#39;-fPIC&#39; $(CUFLAGS) $&lt;$(TARGET_LIB) : $(TARGET_OBJS)$(CC) -o $@  $(TARGET_OBJS) $(LFLAGS)clean:rm -rf $(TARGET_LIB)rm -rf $(TARGET_OBJS)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œæˆ‘ä»¬åªéœ€è¦çŸ¥é“å‡ ä¸ªå‡½æ•°ä¾¿å¯ä»¥å®ç°æˆ‘ä»¬æƒ³è¦çš„åŠŸèƒ½</p><ul><li>CFLAGS+= -I/opt/nvidia/deepstream/deepstream/sources/includes -I/usr/local/cuda-$ åœ¨è¿™é‡Œè¡¨ç¤ºå®šä¹‰ä¸€ä¸ªåä¸ºCUFLAGSçš„å˜é‡ï¼ŒäºæŒ‡å®šç¼–è¯‘CUDAæºæ–‡ä»¶æ—¶è¦ä½¿ç”¨çš„é€‰é¡¹ã€‚å…¶ä¸­ï¼Œ-Ié€‰é¡¹ç”¨äºæŒ‡å®šè¦åŒ…å«çš„å¤´æ–‡ä»¶è·¯å¾„ï¼Œ/opt/nvidia/deepstream/deepstream/sources/includeså’Œ/usr/local/cuda-$(CUDA_VER)/includeåˆ†åˆ«æ˜¯ä¸¤ä¸ªåŒ…å«çš„å¤´æ–‡ä»¶è·¯å¾„ã€‚åœ¨Makefileä¸­ï¼Œå˜é‡ç”¨äºå­˜å‚¨å€¼ï¼Œå¯ä»¥åœ¨Makefileä¸­çš„å…¶ä»–ä½ç½®ä½¿ç”¨ã€‚å¦‚æœæˆ‘ä»¬æƒ³åœ¨å¾…ç¼–è¯‘çš„cppæ–‡ä»¶ä¸­å¼•å…¥&lt;serial/serial.h&gt;å¤´æ–‡ä»¶ï¼Œé‚£ä¹ˆå¯ä»¥åœ¨å…¶ååŠ ä¸Šè¿™å¥:CFLAGS+= -I/opt/ros/melodic/include</li><li>LIBS+= -lnvinfer_plugin -lnvinfer -lnvparsers -L/usr/local/cuda-$(CUDA_VER)/lib64 -lcudart -lcublas -lstdc++fs è¡¨ç¤ºå®šä¹‰ä¸€ä¸ªåä¸ºLIBSçš„å˜é‡ï¼Œå…¶ä¸­åŒ…å«è¦é“¾æ¥çš„åº“æ–‡ä»¶åˆ—è¡¨ï¼ŒåŒ…æ‹¬nvinfer_pluginã€nvinferã€nvparsersã€cudartã€cublaså’Œstdc++fsåº“æ–‡ä»¶ã€‚å¦‚æœæˆ‘ä»¬æƒ³é“¾æ¥åº“æ–‡ä»¶/opt/ros/melodic/lib/libserial.soï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥åŠ ä¸Šè¿™å¥:LIBS+= -L/opt/ros/melodic/lib -lserial</li></ul><p>ä¸€èˆ¬æ¥è¯´äº†è§£äº†è¿™ä¸¤å¥å°±åŸºæœ¬å¯ä»¥è§£å†³å¤§éƒ¨åˆ†é—®é¢˜äº†</p><h3 id="2-3-LD-PRELOADåŠ è½½åŠ¨æ€åº“">2.3 LD_PRELOADåŠ è½½åŠ¨æ€åº“</h3><p>LD_PRELOADæ˜¯ä¸ªç¯å¢ƒå˜é‡ï¼Œç”¨äºåŠ¨æ€åº“çš„åŠ è½½ï¼ŒåŠ¨æ€åº“åŠ è½½çš„ä¼˜å…ˆçº§æœ€é«˜ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå…¶åŠ è½½é¡ºåºä¸ºLD_PRELOAD &gt; LD_LIBRARY_PATH &gt; /etc/ld.so.cache &gt; /lib&gt;/usr/libã€‚ç¨‹åºä¸­æˆ‘ä»¬ç»å¸¸è¦è°ƒç”¨ä¸€äº›å¤–éƒ¨åº“çš„å‡½æ•°ï¼Œä»¥open()å’Œexecve()ä¸ºä¾‹ï¼Œå¦‚æœæˆ‘ä»¬æœ‰ä¸ªè‡ªå®šä¹‰è¿™ä¸¤å‡½æ•°ï¼ŒæŠŠå®ƒç¼–è¯‘æˆåŠ¨æ€åº“åï¼Œé€šè¿‡LD_PRELOADåŠ è½½ï¼Œå½“ç¨‹åºä¸­è°ƒç”¨openå‡½æ•°æ—¶ï¼Œè°ƒç”¨çš„å…¶å®æ˜¯æˆ‘ä»¬è‡ªå®šä¹‰çš„å‡½æ•°ã€‚è¿™ä¸ªåŠŸèƒ½å¯ä»¥å¸®åŠ©æˆ‘ä»¬å®ç°åœ¨æ‰§è¡Œæ–‡ä»¶å¤–éƒ¨é“¾æ¥ä¸€äº›åº“æ–‡ä»¶ã€‚</p><h3 id="2-4-ç›¸å…³ç¼–è¯‘å‘½ä»¤">2.4 ç›¸å…³ç¼–è¯‘å‘½ä»¤</h3><p>ä¸€èˆ¬æ¥è¯´ï¼Œæˆ‘ä»¬ä¼šåœ¨CMakeList.txtçš„åŒçº§è·¯å¾„ä¸‹åˆ›å»ºä¸€ä¸ªbuildæ–‡ä»¶å¤¹ï¼ˆæ–‡ä»¶å¤¹å‘½åå¯éšæ„ï¼‰ï¼Œç„¶åè¿›å…¥åˆ°buildæ–‡ä»¶å¤¹åï¼Œæ‰“å¼€ç»ˆç«¯ï¼Œç„¶åè¾“å…¥å‘½ä»¤ï¼š<code>cmake ..</code><br>ä¹‹åå¾…ç¼–è¯‘å®Œæˆåï¼Œæˆ‘ä»¬ä¼šå‘ç°åœ¨buildæ–‡ä»¶å¤¹ä¸‹ä¼šå‡ºç°Makefileæ–‡ä»¶ï¼Œéšåæˆ‘ä»¬å†åœ¨å‘½ä»¤è¡Œä¸­è¾“å…¥å‘½ä»¤ï¼š<code>make</code><br>æˆåŠŸä¹‹åï¼Œä¾¿ä¼šç”Ÿæˆæˆ‘ä»¬æƒ³è¦çš„å¯æ‰§è¡Œæ–‡ä»¶äº†ã€‚<br>ç›¸å¯¹è·¯å¾„å¦‚ä¸‹æ‰€ç¤ºï¼š<br>----CMakeList.txtâ€ƒ â€‚(<code>$ mkdir build</code>)<br>----buildâ€ƒ â€ƒ â€ƒ â€ƒâ€‰â€‰â€‰(<code>$ cd build</code>)(<code>$ cmake ..</code>)<br>--------Makefileâ€ƒâ€ƒâ€‰(<code>$ make</code>)<br>--------ç›¸å…³å¯æ‰§è¡Œæ–‡ä»¶</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;é—®é¢˜èƒŒæ™¯&quot;&gt;é—®é¢˜èƒŒæ™¯&lt;/h2&gt;
&lt;p&gt;è¿™ä¸ªé—®é¢˜æ˜¯æˆ‘åœ¨åšæµ·èµ›C2æ¯”èµ›ç¼–å†™éƒ¨ç½²è‡ªåŠ¨æ‰“é¶ç®—æ³•é‡åˆ°çš„ã€‚å…ˆç®€å•å™è¿°ä¸€ä¸‹èµ·å› ï¼Œç”±äºæˆ‘ä»¬C2é˜Ÿä¼ä½¿ç”¨çš„æ˜¯Jetson Nanoæ¥è¯†åˆ«é¶å¿ƒï¼Œè¿›è€Œå®ç°è‡ªåŠ¨æ‰“é¶åŠŸèƒ½ï¼Œäºæ˜¯ç®—æ³•è¯†åˆ«è¿™æ–¹é¢å°±ç”±æˆ‘æ¥è¿›å±•ã€‚åœ¨ç½‘ä¸Šå‚è€ƒäº†ä¸€äº›éƒ¨ç½²æ–¹æ¡ˆã€‚æœ€ç»ˆé€‰æ‹©äº†ä½¿</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>å…³äºå¦‚ä½•ä½¿ç”¨Hexoæ­å»ºè‡ªå·±çš„Githubç½‘ç«™</title>
    <link href="https://sprli.github.io/2023/05/18/build_web/"/>
    <id>https://sprli.github.io/2023/05/18/build_web/</id>
    <published>2023-05-18T15:52:40.130Z</published>
    <updated>2023-05-19T03:12:54.918Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ä¸€ã€ä¸‹è½½Gitä¸Nodejs">ä¸€ã€ä¸‹è½½Gitä¸Nodejs</h2><p>è¿™é‡Œå¯ä»¥è‡ªè¡Œå‚è€ƒç½‘ä¸Šæ•™ç¨‹ä¸‹è½½</p><h2 id="äºŒã€ä½¿ç”¨hexoåˆ›å»ºä¸ªäººåšå®¢">äºŒã€ä½¿ç”¨hexoåˆ›å»ºä¸ªäººåšå®¢</h2><h3 id="2-1-åˆ›å»ºBlogæ ¹ç›®å½•">2.1 åˆ›å»ºBlogæ ¹ç›®å½•</h3><ol><li>åœ¨æœ¬åœ°åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œæ­¤æ–‡ä»¶å¤¹å°†ç”¨æ¥ç®¡ç†ä½ çš„ä¸ªäººåšå®¢ç½‘ç«™ï¼Œå¦‚ä¸‹å›¾ï¼Œæˆ‘å†Fç›˜åˆ›å»ºäº†ä¸€ä¸ªgit_blogæ–‡ä»¶å¤¹<br><img src="/images/build_hexo/image1.png" alt="image1"></li><li>ç„¶åæ‰“å¼€Git bashå¹¶è¾“å…¥<code>cd F:/git/blog</code>ï¼Œå¦‚ä¸‹å›¾<br><img src="/images/build_hexo/image2.png" alt="image2"></li><li>ç„¶åå†è¾“å…¥å‘½ä»¤</li></ol><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">npm</span> <span class="token function">install</span> hexo-cli <span class="token parameter variable">-g</span>hexo init<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>å…¶ä¸­hexo initå‘½ä»¤å¯èƒ½ä¼šå¤±è´¥ï¼Œå¯ä»¥å¤šè¯•å‡ æ¬¡ï¼Œæœ€å¥½æŒ‚æ¢¯å­è¿è¡Œ<br>å…¨éƒ¨è¾“å…¥å®Œåï¼Œå¯ä»¥å‘ç°å½“å‰æ–‡ä»¶å¤¹ä¸‹å¤šå‡ºä¸€äº›æ–‡ä»¶å¤¹å’Œç›¸å…³é…ç½®æ–‡ä»¶ã€‚<br><img src="/images/build_hexo/image4.png" alt="image4"></p><ul><li>å…³äºè¿™äº›æ–‡ä»¶å¤¹ï¼Œå¯ä»¥å…ˆåšä¸€ä¸ªç®€å•çš„ä»‹ç»ï¼š<ul><li>node_modules: ä¾èµ–åŒ…</li><li>publicï¼šå­˜æ”¾ç”Ÿæˆçš„é¡µé¢</li><li>scaffoldsï¼šç”Ÿæˆæ–‡ç« çš„ä¸€äº›æ¨¡æ¿</li><li>sourceï¼šç”¨æ¥å­˜æ”¾ä½ çš„æ–‡ç« </li><li>themesï¼šä¸»é¢˜</li></ul></li></ul><ol start="4"><li>ç„¶åè¾“å…¥å‘½ä»¤ï¼š</li></ol><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">npm</span> <span class="token function">install</span>hexo server<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>å®Œæˆåä¼šæ˜¾ç¤ºå¦‚ä¸‹å†…å®¹<br><img src="/images/build_hexo/image5.png" alt="image5"><br>åœ¨æµè§ˆå™¨ä¸­è¾“å…¥<a href="http://localhost:4000/">http://localhost:4000/</a>åå¯ä»¥è¿›å…¥Hexoä¼ ç»Ÿé¡µé¢ï¼Œå¦‚ä¸‹<br><img src="/images/build_hexo/image3.png" alt="image3"></p><h3 id="2-2-Githubåˆ›å»ºä»“åº“">2.2 Githubåˆ›å»ºä»“åº“</h3><ol><li>é¦–å…ˆéœ€è¦ä¸€ä¸ªGithubè´¦å·ï¼Œå…³äºåˆ›å»ºGithubè´¦å·ï¼Œè¿™é‡Œå°±ç•¥å»äº†</li><li>åˆ›å»ºä¸€ä¸ªGithubä»“åº“ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä»“åº“çš„åç§°å¿…é¡»ä¸ºä½ çš„Githubç”¨æˆ·åï¼Œå¦‚ä¸‹ï¼šå› ä¸ºæˆ‘çš„ç”¨æˆ·åä¸ºSprliï¼Œ<a href="http://xn--Sprli-dq1hu9a34zzzxxjp8t7c.github.io">æ•…ä»“åº“åç§°ä¸ºSprli.github.io</a><br><img src="/images/build_hexo/image6.png" alt="image6"></li><li>åˆ›å»ºå®Œåå›åˆ°Git Bashçª—å£ï¼Œè¾“å…¥ä»¥ä¸‹å‘½ä»¤ï¼š</li></ol><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">git</span> config <span class="token parameter variable">--global</span> user.name <span class="token string">"your name"</span> <span class="token comment"># æ³¨æ„è¿™é‡Œæ˜¯ä½ çš„Githubç”¨æˆ·å</span><span class="token function">git</span> config <span class="token parameter variable">--global</span> user.email <span class="token string">"your email"</span> <span class="token comment"># æ³¨æ„è¿™é‡Œæ˜¯ä½ çš„Githubé‚®ç®±</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>å¦‚ä¸‹ï¼š è¿™é‡ŒSprliä¸ºæˆ‘çš„Githubç”¨æˆ·åï¼Œ9****.qq.comä¸ºæˆ‘çš„é‚®ç®±<br><img src="/images/build_hexo/image7.png" alt="image7"></p><h3 id="2-3-åˆ›å»ºsshï¼Œä¾¿äºé“¾æ¥Github">2.3 åˆ›å»ºsshï¼Œä¾¿äºé“¾æ¥Github</h3><ol><li>åˆ›å»ºsshï¼Œ è¾“å…¥å‘½ä»¤åä¸€ç›´å›è½¦å³å¯<br><code>ssh-keygen -t rsa -C &quot;your email</code><br>ä¹‹åä¼šæç¤ºä½ å·²ç»å®Œæˆsshçš„åˆ›å»ºï¼Œåœ¨æ–‡ä»¶å¤¹ä¸­æ‰¾åˆ°.sshè¿™ä¸ªéšè—æ–‡ä»¶å¤¹ï¼Œå…¶ä¸­Springä¸ºæˆ‘ç”µè„‘æœ¬åœ°æˆ·å<br><img src="/images/build_hexo/image8.png" alt="image8"><br>è¿›å…¥è¯¥æ–‡ä»¶å¤¹åï¼Œå¯ä»¥å‘ç°æ–‡ä»¶å¤¹ä¸‹æœ‰å¦‚ä¸‹æ–‡ä»¶ï¼š<br><img src="/images/build_hexo/image9.png" alt="image9"><br>è®°ä½ä¸Šå›¾åœˆçº¢æ–‡ä»¶ï¼Œåœ¨Githubçš„settingä¸­æ‰¾åˆ°SSH keysï¼Œå°†id_rsa.pubä¸­çš„å†…å®¹å…¨éƒ¨å¤åˆ¶åˆ°keyä¸­å»ï¼Œtitleå†…å®¹éšä¾¿å¡«å†™å°±è¡Œ<br><img src="/images/build_hexo/image10.png" alt="image10"><br><img src="/images/build_hexo/image12.png" alt="image12"><br><img src="/images/build_hexo/image13.png" alt="image13"><br>æ“ä½œå®Œæˆåï¼Œæ­å–œä½ ï¼Œå¿«æˆåŠŸäº†ï¼ï¼ï¼</li></ol><h3 id="2-4-å°†hexoéƒ¨ç½²åˆ°Github">2.4 å°†hexoéƒ¨ç½²åˆ°Github</h3><p>åœ¨git_blogæ–‡ä»¶å¤¹ä¸‹æ‰¾åˆ°_config.ymlæ–‡ä»¶ï¼Œè¿™æ˜¯å±äºä½ çš„åšå®¢çš„é…ç½®æ–‡ä»¶ï¼Œå¯ä»¥åœ¨è¿™é‡Œé¢ç›´æ¥ä¿®æ”¹ å§“åï¼Œå†…å®¹ç­‰ç”¨æˆ·çš„ä¿¡æ¯ã€‚ï¼ˆå¯ä»¥ä½¿ç”¨vscodeæˆ–è€…è®°äº‹æœ¬ç­‰ç¼–è¾‘å™¨éƒ½å¯ä»¥ï¼‰</p><h4 id="2-4-1-ä¿®æ”¹å…¶ä¸­çš„å¿…è¦ä¿¡æ¯">2.4.1 ä¿®æ”¹å…¶ä¸­çš„å¿…è¦ä¿¡æ¯</h4><ol><li>ä¿®æ”¹å…¶ä¸­çš„urlä¸º<code>https://username.github.io</code>ï¼Œå…¶ä¸­usernameä¸ºä½ Githubç”¨æˆ·å<br><img src="/images/build_hexo/image14.png" alt="image14"></li><li>å°†deployéƒ¨åˆ†ä¿®æ”¹ä¸ºï¼š</li></ol><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># Deployment</span><span class="token comment">## Docs: https://hexo.io/docs/one-command-deployment</span><span class="token comment"># deploy:</span><span class="token comment">#   type: ''</span>deploy:  type: <span class="token function">git</span>  repo: https://github.com/username/username.github.io.git  <span class="token comment"># å…¶ä¸­çš„usernameæ›¿æ¢ä¸ºä½ çš„Githubç”¨æˆ·å</span>  branch: ph-pages  <span class="token comment"># æ³¨æ„branchä¸èƒ½ä¸ºmasterï¼Œä¸ç„¶å¯èƒ½ä¼šå‡ºé”™</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/images/build_hexo/image15.png" alt="image15"><br>3. å®‰è£…gitéƒ¨ç½²å‘½ä»¤å·¥å…·<br><code>npm install hexo-deployer-git --save</code><br>éšåè¾“å…¥ä»¥ä¸‹å‘½ä»¤æ— é”™è¯¯åå³å®Œæˆåœ¨Githubä¸Šçš„éƒ¨ç½²</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">hexo cleanhexo ghexo d<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>å…¶ä¸­<code>hexo clean</code>æ¸…é™¤äº†ä½ ä¹‹å‰ç”Ÿæˆçš„ä¸œè¥¿ï¼Œä¹Ÿå¯ä»¥ä¸åŠ ã€‚<code>hexo generate</code>ç”Ÿæˆé™æ€æ–‡ç« ï¼Œå¯ä»¥ç”¨<code>hexo g</code>ç¼©å†™ï¼Œ<code>hexo deploy</code>éƒ¨ç½²æ–‡ç« ï¼Œå¯ä»¥ç”¨<code>hexo d</code>ç¼©å†™ã€‚å¦‚æœæ˜¯åœ¨ç¦»çº¿ç«¯å³ localhost:4000ç«¯æµ‹è¯•ä½ çš„åšå®¢ï¼Œåˆ™åªéœ€è¦<code>hexo g</code> + <code>hexo s</code>å³å¯ï¼Œæ— éœ€<code>hexo d</code>ï¼Œå…¶ä¸­<code>hexo s</code>æ˜¯<code>hexo server</code>çš„ç¼©å†™ã€‚</p><h3 id="2-5-å‘å¸ƒè‡ªå·±çš„åšå®¢">2.5 å‘å¸ƒè‡ªå·±çš„åšå®¢</h3><p>åœ¨git_blogæ–‡ä»¶å¤¹ä¸‹æ‰¾åˆ°source/_postsæ–‡ä»¶å¤¹ï¼Œåœ¨å…¶ä¸­åˆ›å»º.mdæ ¼å¼æ–‡ä»¶ï¼Œç„¶ååœ¨å…¶ä¸­ç¼–å†™å®Œè‡ªå·±çš„åšå®¢åï¼Œä½¿ç”¨<code>hexo clean</code> + <code>hexo g</code> + <code>hexo d</code>å³å®Œæˆè‡ªå·±åšå®¢çš„ç¼–å†™ä¸ä¸Šä¼ ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;ä¸€ã€ä¸‹è½½Gitä¸Nodejs&quot;&gt;ä¸€ã€ä¸‹è½½Gitä¸Nodejs&lt;/h2&gt;
&lt;p&gt;è¿™é‡Œå¯ä»¥è‡ªè¡Œå‚è€ƒç½‘ä¸Šæ•™ç¨‹ä¸‹è½½&lt;/p&gt;
&lt;h2 id=&quot;äºŒã€ä½¿ç”¨hexoåˆ›å»ºä¸ªäººåšå®¢&quot;&gt;äºŒã€ä½¿ç”¨hexoåˆ›å»ºä¸ªäººåšå®¢&lt;/h2&gt;
&lt;h3 id=&quot;2-1-åˆ›å»ºBlogæ ¹ç›®å½•&quot;&gt;2.1 åˆ›å»ºB</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>å…³äºJetson Xavier NX æ¿å­çš„ç³»ç»Ÿçƒ§å½•</title>
    <link href="https://sprli.github.io/2023/05/18/Jetson%20NX/"/>
    <id>https://sprli.github.io/2023/05/18/Jetson%20NX/</id>
    <published>2023-05-18T08:07:49.654Z</published>
    <updated>2023-07-29T20:10:41.504Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ä¸€ã€å‡†å¤‡">ä¸€ã€å‡†å¤‡</h2><ol><li>Ubuntuç”µè„‘ or è™šæ‹Ÿæœºï¼ˆUbuntuç³»ç»Ÿï¼‰</li><li>èƒ½å¤Ÿè¿›è¡Œæ•°æ®ä¼ è¾“çš„Micro-USBæ•°æ®çº¿</li><li>æ˜¾ç¤ºå± ã€HDMIè½¬æ¥çº¿ã€é”®é¼ </li></ol><h2 id="äºŒã€è¿›è¡Œçƒ§å½•ï¼ˆå‚è€ƒç‘æ³°æ•™ç¨‹ï¼‰">äºŒã€è¿›è¡Œçƒ§å½•ï¼ˆå‚è€ƒç‘æ³°æ•™ç¨‹ï¼‰</h2><h3 id="2-1-ç³»ç»Ÿè½¯ä»¶åŒ…çš„ä¸‹è½½">2.1 ç³»ç»Ÿè½¯ä»¶åŒ…çš„ä¸‹è½½</h3><p>2.1.1 çƒ§å½•æ‰€éœ€æ–‡ä»¶é›†ä¸­åœ¨è¿™ä¸¤ä¸ªæ–‡ä»¶å¤¹ä¸­ï¼Œåœ¨æœ¬éƒ¨åˆ†æˆ‘é€‰æ‹©å®‰è£…LT4 R32.7.1ç‰ˆæœ¬</p><img src="/images/Jetson/image-20230311205757974.png" alt="image-20230311205757974" style="zoom:50%;" /><p>2.1.2æ ¹æ®Jetsonç±»å‹è¿›è¡Œé€‰æ‹©</p><img src="/images/Jetson/image-20230311205921697.png" alt="image-20230311205921697" style="zoom:50%;" /><p>2.1.3æ ¹æ®è½½æ¿å‹å·è¿›è¡Œé€‰æ‹©</p><img src="/images/Jetson/image-20230311210038630.png" alt="image-20230311210038630" style="zoom:50%;" /><p>2.1.4éšä¾¿é€‰æ‹©ä¸€ä¸ªç‰ˆæœ¬</p><img src="/images/Jetson/image-20230311210058553.png" alt="image-20230311210058553" style="zoom:50%;" /><p>2.1.5ä¸‹è½½å¯¹åº”æ–‡ä»¶ï¼Œå…¶ä¸­rtso-6002å¯¹åº”ä½ç½®å³ä¸ºè½½æ¿å‹å·</p><img src="/images/Jetson/image-20230311210118374.png" alt="image-20230311210118374" style="zoom:50%;" /><p>2.1.6é€‰æ‹©å¯¹åº”ç‰ˆæœ¬çš„L4Tæ–‡ä»¶</p><img src="/images/Jetson/image-20230311210156444.png" alt="image-20230311210156444" style="zoom:50%;" /><p>2.1.7ä¸‹è½½ç›¸åº”æ–‡ä»¶</p><img src="/images/Jetson/image-20230311210216935.png" alt="image-20230311210216935" style="zoom:50%;" /><h3 id="2-2-åœ¨PCç«¯Ubuntuç³»ç»Ÿè¿›è¡Œçƒ§å½•ç¯å¢ƒå‡†å¤‡">2.2 åœ¨PCç«¯Ubuntuç³»ç»Ÿè¿›è¡Œçƒ§å½•ç¯å¢ƒå‡†å¤‡</h3><p>2.2.1 å°†ä¸Šè¿°æ–‡ä»¶æ‹·è´è‡³çƒ§å½•ä¸»æœºåŒä¸€ç›®å½•ä¸‹</p><p>2.2.2 è§£å‹ Linux Driver Package</p><p><code>$ tar -vxf Jetson_Linux_R32.7.1_aarch64.tbz2</code></p><p>2.2.3 è®¾ç½®æ ¹æ–‡ä»¶ç³»ç»Ÿ</p><ol><li><p>è¿›å…¥Linux Driver Package çš„æ ¹æ–‡ä»¶ç³»ç»Ÿç›®å½•</p><p><code>$ cd &lt;your_L4T_root&gt;/Linux_for_Tegra/roofs</code></p></li><li><p>è§£å‹ the Root File System ï¼š</p><p><code>$ sudo tar -jxpf ../../Tegra_Linux_Sample-Root-Filesystem_R32.7.1_aarch64.tbz2</code></p></li></ol><p>2.2.4 å®‰è£… BSP æ”¯æŒåŒ…</p><ol><li><p>å°† Realtimes-L4T-<version>.tar åŒ…è§£å‹åˆ°ä¸ Linux_for_Tegra æ–‡ä»¶å¤¹åŒçº§ç›®å½•ä¸‹é¢ï¼Œä½¿ç”¨å‘½ä»¤ï¼š</p><p><code>$ tar -xvf Realtimes-L4T-&lt;version&gt;.tar</code></p></li><li><p>è¿›å…¥åˆ° Realtimes-L4T æ–‡ä»¶å¤¹ï¼Œè¿è¡Œï¼š</p><p><code>$ sudo ./install.sh</code><br>å®‰è£…æˆåŠŸä¼šæœ‰ success æç¤ºï¼</p></li><li><p>è¿è¡Œ apply_binaries.sh è„šæœ¬æ‹·è´ NVIDIA ç”¨æˆ·ç©ºé—´åº“è¿›å…¥ç›®æ ‡æ–‡ä»¶ç³»ç»Ÿ<br><code>$ cd ../Linux_for_Tegra/</code><br><code>$ sudo ./apply_binaries.sh</code></p></li></ol><h3 id="3-1-ç³»ç»Ÿçƒ§å½•">3.1 ç³»ç»Ÿçƒ§å½•</h3><p>3.3.1å…ˆcå°†æ¿å­è¿›å…¥recoveryæ¨¡å¼ï¼Œç„¶åå°†æ¿å­ä¸ä¸»æœºé€šè¿‡Micro-USBæ•°æ®çº¿è¿æ¥ï¼Œåœ¨PCç«¯çš„Linux_for_Tegraç›®å½•ä¸‹è¿›è¡Œå¦‚ä¸‹æ“ä½œï¼š<br><code>$ sudo ./flash.sh realtimes/rtso-&lt;model&gt; mmcblk0p1</code><br>æ³¨æ„ï¼šrtso-<model>æŒ‡çš„æ˜¯æ¿å­å‹å·ï¼Œä¾‹å¦‚æˆ‘ä½¿ç”¨çš„æ¿å­æ˜¯rtso-6002E-v1.2ï¼Œåˆ™å‘½ä»¤ä¸ºï¼š<br><code>$ sudo ./flash.sh rtso-6002e-1.2v mmcblk0p1</code></p><p>3.3.2 å¯èƒ½é‡åˆ°çš„é—®é¢˜</p><ol><li><p>æ¿å­å‹å·æŸ¥çœ‹ï¼Œä¸€èˆ¬æ¥è¯´æ¿å­ä¸Šä¼šå¸¦æœ‰å‹å·ï¼Œè‹¥æ‰¾ä¸åˆ°å¯ä»¥å’¨è¯¢å–æ–¹</p><img src="/images/Jetson/image-20230311213021400.png" alt="image-20230311213021400" style="zoom:50%;" /></li><li><p>å…³äºè¾“å…¥é€‰é¡¹ï¼Œå¦‚ä¸‹ï¼Œå¯ä»¥å‘ç°çº¢æ¡†åœˆä¸­çš„æœ‰å¾ˆå¤šå‹å·çš„é€‰é¡¹ï¼Œå…¶ä¸­rtso-6002eè¡¨ç¤ºrtso-6002-emmcæ¿ï¼Œrtso-6002åˆ™æ˜¯å¦ä¸€ç§ç±»å‹çš„æ¿å­ï¼Œå¹¶ä¸”6002-emmcä¸‹è¿˜æœ‰v1.2ã€v1.3ç­‰å‹å·ï¼Œæ ¹æ®æ¿å­è¿›è¡Œé€‰æ‹©ã€‚ï¼ˆä¸€å®šä¸è¦å¼„é”™ï¼Œè¿™äº›æ–‡ä»¶æ˜¯ä¸ä¸»æ¿ç›¸é…çš„ï¼‰</p></li></ol><p><img src="/images/Jetson/image-20230311214628664.png" alt="image-20230311214628664"></p><p>3.3.3 æŠ¥é”™ä¸€</p><p><img src="/images/Jetson/image-20230311214653624.png" alt="image-20230311214653624"></p><p>å¦‚ä¸ŠæŠ¥é”™éœ€è€ƒè™‘ä¸¤ä¸ªåŸå› ï¼š</p><ol><li>ä¸»æœºä¸æ¿å­è¿›è¡Œæ•°æ®ä¼ è¾“çš„Micro-USBæ•°æ®çº¿æ˜¯å¦å…·æœ‰ä¼ è¾“æ•°æ®çš„ä½œç”¨ï¼Œå¯ä»¥ä½¿ç”¨lsusbæŸ¥çœ‹æ˜¯å¦å«æœ‰Nvidia Cropï¼›</li><li>æ¿å­æ˜¯å¦è¿›å…¥äº†recoveryæ¨¡å¼ã€‚</li></ol><p>3.3.4 æŠ¥é”™äºŒ</p><p><img src="/images/Jetson/image-20230319005550878.png" alt="image-20230319005550878"></p><p>ä»”ç»†è§‚å¯Ÿå¯ä»¥å‘ç°é—®é¢˜åœ¨äºä¸€ä¸ª<code>.py</code>æ–‡ä»¶æ‰§è¡Œé”™è¯¯ï¼Œå¯ä»¥ä½¿ç”¨å‘½ä»¤<code>$ sudo apt install python2.7 python3 python</code>å®‰è£…pythonï¼Œç„¶åé‡æ–°çƒ§å½•è§£å†³ã€‚</p><h3 id="3-4-é…ç½®æ¿å­ç³»ç»Ÿ">3.4 é…ç½®æ¿å­ç³»ç»Ÿ</h3><p>ç”±äºç‘æ³°æ¿å­æ˜¯ä¸Šç”µè‡ªå¯åŠ¨çš„ï¼Œå°†æ¿å­å’Œæ˜¾ç¤ºå±ä»¥åŠé”®é¼ è¿æ¥ï¼Œè¿›å…¥ç±»ä¼¼Ubuntuç³»ç»Ÿå¼€æœºé…ç½®ç•Œé¢ï¼Œé™¤äº†åœ°åŒºé€‰æ‹©ä¸Šæµ·å¤–ï¼Œå…¶ä½™ä¿æŒé»˜è®¤å³å¯ã€‚èƒ½å¤Ÿæ­£å¸¸å¼€æœºï¼Œåˆ™è¡¨æ˜çƒ§å½•æˆåŠŸã€‚éšåå¯ä»¥å‘ç°ï¼Œå…¶å›¾å½¢åŒ–ç•Œé¢å’ŒUbuntuå‡ ä¹æ²¡æœ‰ä»€ä¹ˆåŒºåˆ«ã€‚</p><h2 id="ä¸‰ã€è¿›è¡Œç³»ç»Ÿè¿ç§»ï¼ˆè§†æƒ…å†µé€‰æ‹©ï¼‰">ä¸‰ã€è¿›è¡Œç³»ç»Ÿè¿ç§»ï¼ˆè§†æƒ…å†µé€‰æ‹©ï¼‰</h2><h3 id="3-1-æ–¹æ³•ä¸€">3.1 æ–¹æ³•ä¸€</h3><p>3.1.1 æŸ¥çœ‹SSDè®¾å¤‡åç§°<br>ç³»ç»Ÿå¯åŠ¨å‰ï¼Œå°†SSDæ’å…¥åˆ°æ¿å­çš„å†…å­˜æ¥å£å¤„ï¼ˆç”±äºç‘æ³°æ¿å­è‡ªèº«è£…æœ‰ä¸€ä¸ª120GBçš„å†…å­˜å¡ï¼Œå› æ­¤å¯ä»¥ç›´æ¥ä½¿ç”¨å…¶è‡ªèº«çš„SSDå¡å³å¯ï¼‰ã€‚ç³»ç»Ÿå¯åŠ¨åï¼Œä½¿ç”¨<code>$ sudo fdisk -l</code>å‘½ä»¤æŸ¥çœ‹SSDè®¾å¤‡åç§°ï¼Œä¾‹å¦‚ï¼šnvme0n1ã€mmcblk1ï¼Œæœ¬æ–‡ä½¿ç”¨mmcblk1ä¸ºä¾‹ã€‚<br>3.1.2 å¯¹SSDè¿›è¡Œæ ¼å¼åŒ–<br>å¦‚æœSSDä¹‹å‰æ²¡æœ‰è¿›è¡Œæ ¼å¼åŒ–ï¼Œéœ€è¦æŠŠSSDæ ¼å¼åŒ–åå†ä½¿ç”¨ã€‚å¯¹äºå·²æŒ‚è½½çš„SSDå¡ï¼Œéœ€è¦ä½¿ç”¨umountå¸è½½SSDå¡ï¼Œå†æ ¼å¼åŒ–ã€‚å¸è½½å‘½ä»¤ï¼š<code>sudo umount /dev/mmcblk1</code>ï¼›æ ¼å¼åŒ–å‘½ä»¤ï¼š<code>$ sudo mkfs.ext4 /dev/mmcblk1</code><br>3.1.3 åˆ›å»ºä¸€ä¸ªæ–°çš„GPTåˆ†åŒº<br><code>$ sudo parted /dev/mmcblk1 mklabel gpt</code><br>3.1.4 æ·»åŠ åˆ†åŒº<br><code>$ sudo parted /dev/mmcblk1 mkpart primary 0GB &lt;Size&gt;</code><br>Sizeæ˜¯åˆ†åŒºçš„å¤§å°ï¼Œæœ€å°8GBï¼Œå»ºè®®å¯ä»¥å°†SSDå¡å†…å­˜å…¨éƒ¨æ·»å…¥<br>ä¾‹å¦‚ï¼šå‡†å¤‡åˆ†åŒºçš„å¤§å°æ˜¯50GBï¼Œåˆ™å‘½ä»¤æ˜¯ï¼š<br><code>$ sudo parted /dev/mmcblk1 mkpart primary 0GB 50GB</code><br>æ·»åŠ å®Œåˆ†åŒºåï¼Œä½¿ç”¨<code>$ sudo fdisk -l</code>å¯ä»¥çœ‹åˆ°mmcblk1ä¸‹æ–°å¢ä¸€ä¸ªåˆ†åŒºï¼Œåä¸ºï¼šmmcblk1p1</p><p>3.1.5 æ ¼å¼åŒ–åˆ†åŒº<br><code>$ sudo mkfs.ext4 /dev/mmcblk1p1</code><br>æŠŠåˆ†åŒºæ ¼å¼åŒ–ä¸ºext4 æ ¼å¼<br>3.1.6 æ‹·è´roofsåˆ°SSD<br><code>$ sudo dd if=/dev/mmcblk0p1 of=/dev/mmcblk1p1 bs=1M</code><br>å…¶ä¸­mmcblk0p1æ˜¯ç³»ç»ŸåŸå…ˆæ‰€åœ¨ä½ç½®ï¼Œmmcblk1p1åˆ™æ˜¯æˆ‘ä»¬çš„è½¬ç§»ç›®æ ‡åŒºåŸŸ<br>3.1.7 ä¿®å¤åˆ†åŒº<br><code>$ sudo -s</code><br><code>$ fsck.ext4 /dev/mmcblk1p1</code><br>è‹¥é‡åˆ°è¾“å…¥yes or noï¼Œè¯·å…¨éƒ¨è¾“å…¥yes</p><p>3.1.8 è°ƒæ•´ç³»ç»Ÿåˆ†åŒºå¤§å°<br><code>$ sudo resize2fs /dev/mmcblk1p1</code></p><p>3.1.9 çƒ§å†™ä»SDå¡å¯åŠ¨ç³»ç»Ÿ<br><code>$ sudo ./flash.sh realtimes/rtso-&lt;model&gt; mmcblk1p1</code><br>è¿™ä¸€æ­¥éª¤å’Œçƒ§å½•æ­¥éª¤ä¸€æ‘¸ä¸€æ ·ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ç›®å½•ä½ç½®ã€çƒ§å½•ç³»ç»Ÿæ–‡ä»¶ä¸æœ€å¼€å§‹çƒ§å½•æ—¶æ˜¯ä¸€æ ·çš„ï¼Œä¸”ç›®æ ‡ä½ç½®åç§°å˜åŒ–äº†<br>é‡æ–°çƒ§å½•å®Œåï¼Œè¿›å…¥ç³»ç»Ÿåï¼Œè¾“å…¥<code>$ df -h</code>å¯ä»¥çœ‹åˆ°mmcblk1p1æˆä¸ºæ ¹ç›®å½•ï¼Œç³»ç»Ÿå·²ä»SDå¡å¯åŠ¨ã€‚</p><h3 id="3-2-æ–¹æ³•äºŒ">3.2 æ–¹æ³•äºŒ</h3><p>[^å‚è€ƒåšå®¢]: <a href="http://t.csdn.cn/Ne0Bk">http://t.csdn.cn/Ne0Bk</a>  <a href="http://t.csdn.cn/ZrDlI">http://t.csdn.cn/ZrDlI</a></p><p>3.2.1 å°†SDå¡è¿›è¡Œæ ¼å¼åŒ–æ“ä½œå¹¶æŒ‚è½½åˆ°ç³»ç»Ÿä¸‹ï¼Œæ“ä½œå¦‚ä¸‹ï¼š<br>ç³»ç»Ÿè¿ç§»çš„å‰ææ˜¯å°†SDå¡æŒ‚è½½åˆ°ç³»ç»Ÿä¸‹ï¼Œå…ˆéœ€è¦ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤å°†SDå¡æ ¼å¼åŒ–ä¸ºEXT4æ ¼å¼ï¼š<br><code>$ sudo mke2fs -t ext4 /dev/mmcblk1p1</code><br>ç„¶åå°†SDå¡æŒ‚è½½åˆ°/mntä¸‹ï¼š<br><code>$ sudo mount /dev/mmcblk1p1 /mnt</code></p><p>3.2.2 å…‹éš†æ‰€éœ€æ–‡ä»¶ï¼š</p><p><code>$ git clone https://github.com/jetsonhacks/rootOnNVMe.git</code></p><p>3.2.3 è¿›å…¥ä¸‹è½½çš„æ–‡ä»¶å¤¹ä¸­ï¼Œ<a href="http://xn--copy-rootfs-ssd-gm6x791zrggm36j4oi1j3f.sh">ç¼–è¾‘è„šæœ¬æ–‡ä»¶copy-rootfs-ssd.sh</a>ï¼Œç„¶åè¿è¡Œè¯¥è„šæœ¬ï¼Œå°†ç³»ç»Ÿå¤åˆ¶åˆ°SSDä¸­ã€‚<br><code>cd ./rootOnNVMe</code><br><code>sudo gedit ./copy-rootfs-ssd.sh</code><br>å°†æ–‡ä»¶ä¸­çš„<code>/dev/nvme0n1p1 </code>ä¿®æ”¹ä¸º<code>/dev/mmcblk1</code><br><code>sudo ./copy-rootfs-ssd.sh</code></p><img src="/images/Jetson/image-20230311225106076.png" alt="image-20230311225106076" style="zoom: 80%;" /><p>3.2.4 è¿›å…¥åˆ°<code>rootOnNVMe/data</code>ç›®å½•ä¸‹ï¼Œä¿®æ”¹å…¶ä¸­çš„è„šæœ¬æ–‡ä»¶:<code>setssdroot.sh</code>ä¸<code>setssdroot.service</code>ï¼Œå°†å…¶ä¸­çš„<code>/dev/nvme0n1p1</code>ä¿®æ”¹ä¸º<code>/dev/mmcblk1</code>ï¼Œæ–¹æ³•åŒä¸Šã€‚</p><p><img src="/images/Jetson/image-20230311225229373.png" alt="image-20230311225229373"></p><p>3.2.5 å›åˆ°rootOnNVMeç›®å½•ä¸‹ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š<br><code>sudo ./setup-service.sh</code></p><p>æˆåŠŸåå¦‚ä¸‹å›¾ï¼š</p><img src="/images/Jetson/image-20230311225311334.png" alt="image-20230311225311334" style="zoom:50%;" /><p>3.2.6 é‡æ–°å¯åŠ¨jetsonæ¿åï¼Œä½¿ç”¨å‘½ä»¤<code>$ df -h</code>æŸ¥çœ‹ï¼Œå¯ä»¥å‘ç°ç³»ç»Ÿå·²ç»å®Œæˆè¿ç§»</p><h2 id="å››ã€å®‰è£…Jepack">å››ã€å®‰è£…Jepack</h2><h3 id="4-1ã€åŸºæœ¬æ­¥éª¤">4.1ã€åŸºæœ¬æ­¥éª¤</h3><p>4.1.1 å®‰è£…å‰ä¿¡æ¯ç¡®è®¤ä»¥åŠæ›´æ–°è½¯ä»¶æºï¼ˆåœ¨æ¿å­ä¸Šè¿›è¡Œï¼‰<br>ç»™Xavier NXå®‰è£…è½¯ä»¶ä¹‹å‰éœ€å…ˆç¡®å®šjetsonè®¾å¤‡ç³»ç»Ÿl4tç‰ˆæœ¬ï¼Œå› ä¸ºNVDIA jetpackè·Ÿè¯¥ç‰ˆæœ¬å·å…·æœ‰ä¸€å®šçš„å¯¹åº”å…³ç³»ï¼Œå¦‚æœç‰ˆæœ¬å·ä¸å¯¹åº”ä¼šå¯¼è‡´å‡ºç°ä¸€äº›å¼‚å¸¸ã€‚å…·ä½“çš„å¯¹åº”å…³ç³»å¯ä»¥å‚è€ƒJetpackçš„è¯´æ˜ï¼š</p><p>åœ¨Xavier NXè®¾å¤‡ä¸Šä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å¯ä»¥æŸ¥çœ‹ç³»ç»Ÿçš„L4Tç‰ˆæœ¬å·ï¼š<br><code>$ headâ€“n 1 /etc/nv_tegra_release</code></p><p>4.1.2 è¿›å…¥è½½æ¿ç³»ç»Ÿï¼Œæ‰“å¼€SysteamSettingsâ€“&gt;Software&amp;Updates&gt;Ubuntu Software</p><p>4.1.3 ä¸‹è½½å®‰è£…Jetpack/sdkmanagerå¹¶è¿è¡Œï¼ˆåœ¨PCç«¯Ubuntuç³»ç»Ÿä¸Šè¿›è¡Œï¼‰<br>[sdkmanagerä¸‹è½½ç½‘å€]: <a href="https://developer.nvidia.com/drive/sdk-manager">https://developer.nvidia.com/drive/sdk-manager</a></p><p>é€‰æ‹©å®‰è£…æœ€æ–°ç‰ˆæœ¬çš„sdkmanagerä¸‹è½½å®‰è£…<br>å®‰è£…å‘½ä»¤ï¼š<code>$ sudo dpkg -i sdkmage&lt;â€¦â€¦&gt;.deb</code> or <code>$ sudo apt install ./sdkmanger-&lt;â€¦â€¦&gt;.deb</code><br>è¿è¡Œå‘½ä»¤ï¼š<code>$ sdkmanager</code></p><p>è¿è¡Œç•Œé¢å’Œæ“ä½œå¦‚ä¸‹ï¼š</p><ol><li><p>ç™»å½•ç•Œé¢ï¼ˆä½ç‰ˆæœ¬å¯èƒ½æ— æ³•ç™»å½•ï¼‰</p><img src="/images/Jetson/image-20230311232026679.png" alt="image-20230311232026679" style="zoom:50%;" /></li><li><p>ç‚¹å‡»åœˆä¸­çš„1ã€2ï¼Œè¿›è¡Œé€‰æ‹©Jetsonç±»å‹ä»¥åŠä¸LT4ç›¸å¯¹åº”çš„Jetpackç‰ˆæœ¬ï¼Œ3å–æ¶ˆå‹¾é€‰ã€‚å¦‚æœ2ä¸­æœªå‘ç°ä¸å…¶å¯¹åº”çš„Jetpackç‰ˆæœ¬ï¼Œåˆ™è¿è¡Œsdkmanagerçš„å‘½ä»¤æ”¹ä¸ºï¼š<code>$ sdkmanager --archivedversions</code>ï¼Œå…¶å®ƒæ“ä½œä¸å˜ã€‚</p><img src="/images/Jetson/image-20230311232300525.png" alt="image-20230311232300525" style="zoom:50%;" /></li><li><p>ç”±äºä»¥åŠå®‰è£…è¿‡ç³»ç»Ÿï¼Œåœˆä¸­çš„1å–æ¶ˆå‹¾é€‰ï¼Œåœˆä¸­çš„2å¯ä»¥é€‰æ‹©åˆé€‚çš„ä½ç½®ï¼ˆé»˜è®¤ä¸å˜ï¼‰ï¼Œåœˆä¸­çš„3æ³¨æ„å–æ¶ˆå‹¾é€‰<strong>Download now.Install later.<strong>ç‚¹å‡»</strong>continue</strong>ã€‚</p><img src="/images/Jetson/image-20230311233159191.png" alt="image-20230311232542687" style="zoom:50%;" /></li><li><p>è¾“å…¥PCç«¯Ubuntuä¸»æœºå¯†ç </p><img src="/images/Jetson/image-20230311232559144.png" alt="image-20230311232559144" style="zoom:50%;" /></li><li><p>åœˆä¸­çš„1ï¼Œå®é™…ä¸Šåº”æ˜¯æ˜¾ç¤ºæœ‰è®¾å¤‡è¿æ¥çš„ï¼›åœˆä¸­çš„2å¡«å†™<strong>æ¿å­Ubuntuç³»ç»Ÿ</strong>çš„Usernameå’ŒPasswordï¼›éšåç‚¹å‡»Installã€‚</p><img src="/images/Jetson/image-20230311233500272.png" alt="image-20230311233500272" style="zoom:50%;" /></li><li><p>æ¥ç€è¿›å…¥ä»¥ä¸‹ç•Œé¢ï¼Œè¿™äº›æŒ‡æ ‡éƒ½æ˜¯æ¿å­çš„æŒ‡æ ‡ï¼Œå¦‚å†…å­˜æ˜¯å¦è¶³å¤Ÿã€ç½‘ç»œæ˜¯å¦è¿æ¥ç­‰ã€‚</p><p><img src="/images/Jetson/image-20230311234633908.png" alt="image-20230311234633908"></p><p>7.æœ€åå‡ºç°æ¥ä¸‹æ¥ç”»é¢å³æˆåŠŸ</p><p><img src="/images/Jetson/image-20230319113455316.png" alt="image-20230319113455316"></p></li></ol><h3 id="4-2-é—®é¢˜åŠè§£å†³">4.2 é—®é¢˜åŠè§£å†³</h3><p>4.2.1 å¦‚ä¸Šå›¾ï¼Œå¦‚æœå‡ºç°Internet connectioné—®é¢˜ï¼ŒæŒ‰ç…§å…¶æŒ‡ç¤ºå¯ä»¥é‡‡å–å¦‚ä¸‹æ–¹æ³•è§£å†³ï¼š</p><ol><li>åœ¨jetsonæ¿ä¸Šç»ˆç«¯è¾“å…¥ï¼š<code>$ ping -c 3 www.nvidia.com</code></li></ol><p><img src="/images/Jetson/image-20230311234239264.png" alt="image-20230311234239264"></p><ol start="2"><li><p>å°†å‡ºç°çš„Ipåœ°å€æ”¾åˆ°jetsonæ¿å­çš„/etc/hostsæ–‡ä»¶ä¸­</p></li><li><p>ä½¿ç”¨å‘½ä»¤ï¼š<code>$ sudo gedit /etc/hosts</code></p></li></ol><p>â€‹       åœ¨æ–‡ä»¶ä¸­æ·»åŠ ä¸€è¡Œï¼š<code>23.48.214.59 nvidia.com</code></p><ol start="4"><li>ä¿å­˜åç‚¹å‡»Retryå³å¯ã€‚</li></ol><p>å¦‚æœä¸Šè¿°æ–¹æ³•è¡Œä¸é€šï¼Œåˆ™å¯èƒ½æ˜¯sdkmanager<strong>ç‰ˆæœ¬ä¸æ˜¯æœ€æ–°</strong>é€ æˆçš„ã€‚</p><p>4.2.2 è‹¥å‡ºç°ç¬¬ä¸‰ä¸ªAccept to APTâ€¦â€¦é”™è¯¯ï¼Œåˆ™å¯èƒ½æ˜¯jetsonæ¿ä¸Šçš„æºæœªæ›´æ–°é€ æˆçš„ã€‚</p><ol><li>å¯ä»¥åœ¨jetsonæ¿ä¸Šä¾æ¬¡è¾“å…¥å‘½ä»¤ï¼š</li></ol><p><code>$ sudo apt-get update</code> &amp;<code>$ sudo apt-get upgrade</code></p><ol start="2"><li><p>æ›´æ–°å®ŒåRetryå³å¯ã€‚</p></li><li><p>æœ‰æ—¶å…‰å¤šRetryå‡ æ¬¡å¯èƒ½å°±ä¼šæˆåŠŸã€‚</p></li></ol><p>è‹¥ä¸Šè¿°æ“ä½œå¤±æ•ˆï¼Œåˆ™å¯ä»¥æ›¿æ¢Jetsonæ¿ä¸Šçš„Ubuntuæºï¼ˆæ³¨æ„æ˜¯<strong>Jetsonæº</strong>ï¼‰ï¼Œé‡æ–°æ›´æ–°å°è¯•ä¸€ä¸‹ï¼›æˆ–è€…é€€å‡ºsdkmanageré‡æ–°å¼„ä¸€éã€‚</p><h2 id="äº”ã€å®‰è£…ç³»ç»Ÿæ‰€éœ€çš„åŒ…">äº”ã€å®‰è£…ç³»ç»Ÿæ‰€éœ€çš„åŒ…</h2><h3 id="5-1-é…ç½®cudaç¯å¢ƒå˜é‡">5.1 é…ç½®cudaç¯å¢ƒå˜é‡</h3><p><code>vi ~/.bashrc  # æ‰“å¼€/.bashrcæ–‡ä»¶</code><br>å°†ä»¥ä¸‹å†…å®¹è¾“å…¥è¯¥æ–‡ä»¶ä¸­ï¼ˆæœ«å°¾å³å¯ï¼‰</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">export</span> <span class="token assign-left variable"><span class="token environment constant">PATH</span></span><span class="token operator">=</span>/usr/local/cuda10.2/bin:<span class="token environment constant">$PATH</span> <span class="token comment"># cudaåè·Ÿçš„æ˜¯cudaç‰ˆæœ¬</span><span class="token builtin class-name">export</span> <span class="token assign-left variable">LD_LIBRARY_PATH</span><span class="token operator">=</span>/usr/local/cuda10.2/lib64:<span class="token variable">$LD_LIBRARY_PATH</span><span class="token builtin class-name">export</span> <span class="token assign-left variable">CUDA_ROOT</span><span class="token operator">=</span>/usr/local/cuda10.2  <span class="token comment"># è¿™ä¸€é¡¹ä¸æ˜¯å¾ˆç¡®å®šæ˜¯å¦æœ‰ç”¨</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="5-2-é…ç½®ç³»ç»Ÿçº§å®‰è£…åŒ…">5.2 é…ç½®ç³»ç»Ÿçº§å®‰è£…åŒ…</h3><p>è¾“å…¥ä»¥ä¸‹å‘½ä»¤å³å¯</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> build-essential <span class="token function">make</span> cmake cmake-curses-gui<span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> <span class="token function">git</span> g++ pkg-config <span class="token function">curl</span>  <span class="token function">zip</span> zlib1g-dev libopenblas-base libopenmpi-dev <span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> libatlas-base-dev gfortran libcanberra-gtk-module libcanberra-gtk3-module<span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> libhdf5-serial-dev hdf5-tools libhdf5-dev<span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> <span class="token function">nano</span> <span class="token function">locate</span> <span class="token function">screen</span><span class="token comment">#scipy ä¾èµ–å’Œ cython</span><span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> libfreetype6-dev <span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> protobuf-compiler libprotobuf-dev openssl<span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> libssl-dev libcurl4-openssl-dev<span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> cython3<span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> libxml2-dev libxslt1-dev<span class="token comment">#opencv ä¾èµ–</span><span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> libavcodec-dev libavformat-dev libswscale-dev<span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> libxvidcore-dev libavresample-dev<span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> libtiff-dev libjpeg-dev libpng-dev<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="5-3-å®‰è£…é…ç½®Python">5.3 å®‰è£…é…ç½®Python</h3><p>5.3.1 é»˜è®¤å®‰è£…python3.6ç‰ˆæœ¬</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> <span class="token parameter variable">-y</span> python3-dev python3-testresources python3-setuptools<span class="token function">wget</span> https://bootstrap.pypa.io/pip/3.6/get-pip.py<span class="token function">sudo</span> python3 get-pip.py <span class="token comment"># è¯¥å‘½ä»¤å¯èƒ½ä¼šå¤±è´¥ï¼Œæ˜¾ç¤ºpython3ä½¿ç”¨çš„python3.6ç‰ˆæœ¬è¾ƒä½ï¼Œå¯¼è‡´ä¸æˆåŠŸï¼Œåªè¦ä¸‹è½½å¯¹åº”ç‰ˆæœ¬çš„pipå°±è¡Œï¼Œä½¿ç”¨ä»¥ä¸‹å‘½ä»¤è¿›è¡Œæ›¿æ¢ï¼šwget https://bootstrap.pypa.io/pip/3.6/get-pip.py</span><span class="token function">rm</span> get-pip.py <span class="token comment"># ç„¶åæ¢pipæº</span><span class="token function">mkdir</span> ~/.pip<span class="token function">vim</span> ~/.pip/pip.conf <span class="token comment"># æ¢æ¸…åæº</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç²˜è´´ä»¥ä¸‹å†…å®¹åˆ°è¯¥æ–‡ä»¶<br><code>[global] index-url = https://pypi.tuna.tsinghua.edu.cn/simple</code></p><p>5.3.2 è§£å†³sudo python3 get-pip.pyå¤±è´¥ï¼Œè¿™é‡Œæˆ‘é€‰æ‹©ä½¿ç”¨python3.7ç‰ˆæœ¬</p><ol><li>å®‰è£…python3.7</li></ol><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">apt-get</span> update  <span class="token comment"># æ›´æ–°(å¯è·³è¿‡)</span><span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> python3.7python3.7 <span class="token parameter variable">-V</span>  <span class="token comment">#æŸ¥çœ‹æ˜¯å¦å®‰è£…æˆåŠŸ</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><ol start="2"><li>åˆ›å»ºè½¯è¿æ¥ï¼Œä½¿python3é»˜è®¤æŒ‡å‘python3.7</li></ol><ul><li>é¦–å…ˆæŠŠä¹‹å‰çš„è½¯è¿æ¥åˆ é™¤ï¼š</li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">rm</span> <span class="token parameter variable">-rf</span> /usr/bin/python3 <span class="token function">which</span> python3.7  <span class="token comment"># æŸ¥çœ‹python3.7 å®‰è£…è·¯å¾„.è¿™é‡Œè¾“å‡º/usr/bin/python3.7</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><ul><li>åˆ›å»ºæ–°çš„è½¯è¿æ¥ï¼š</li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">ln</span> <span class="token parameter variable">-s</span> /usr/bin/python3.7 /usr/bin/python3  <span class="token comment"># æ·»åŠ python3çš„è½¯é“¾æ¥ã€‚ /usr/bin/python3.7 å³ which python3.7è¾“å‡ºçš„å®‰è£…è·¯å¾„</span>python3 <span class="token parameter variable">-V</span>  <span class="token comment"># æµ‹è¯•æ˜¯å¦å®‰è£…æˆåŠŸ</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><ol start="3"><li>åˆ‡æ¢pythonç‰ˆæœ¬ï¼Œ<br><a href="jetson%E5%8F%AF%E4%BB%A5%E5%AE%89%E8%A3%85minconda%E6%9D%A5%E4%BD%BF%E7%94%A8conda%E7%9B%B8%E5%85%B3%E5%91%BD%E4%BB%A4%EF%BC%8C%E4%BD%86%E6%98%AF%E4%B8%8D%E5%A6%82%E5%AE%89%E8%A3%85virtualenv%E6%9D%A5%E7%9A%84%E6%96%B9%E4%BE%BF%EF%BC%8C%E5%B9%B6%E4%B8%94%E5%8D%A0%E5%86%85%E5%AD%98%E4%B9%9F%E4%B8%8D%E5%B0%8F">^è§£é‡Š</a>: å¯¹äºä¸åŒç‰ˆæœ¬çš„jetpackï¼Œå…¶cudaå¯¹åº”çš„pythonç‰ˆæœ¬æœ‰æ‰€ä¸åŒï¼Œä½¿ç”¨è¯¥æ–¹æ³•ä¾¿äºé…åˆcudaçš„ä½¿ç”¨</li></ol><ul><li>é¦–å…ˆæŸ¥çœ‹pythonæ–‡ä»¶<br><code>ls /usr/bin/python* # æŸ¥çœ‹pythonæ–‡ä»¶ï¼Œä¼šå‡ºç°python2.7ã€python3.6ã€python3.7ä¸‰ä¸ªç‰ˆæœ¬</code></li><li>é¦–å…ˆçœ‹çœ‹ç³»ç»Ÿæ˜¯å¦é…ç½®è¿‡pythonç›¸å…³çš„ç®¡ç†ä¿¡æ¯<br><code>update-alternatives --list python # å¦‚æœæ˜¾ç¤ºï¼šno alternatives for pythonï¼Œè¡¨ç¤ºæ²¡æœ‰é…ç½®è¿‡ã€‚</code></li><li>ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤è¿›è¡Œé…ç½®ï¼š</li></ul><pre name="code" class="python">sudo update-alternatives --install /usr/bin/python python /usr/bin/python2.7 1sudo update-alternatives --install /usr/bin/python python /usr/bin/python3.6 2sudo update-alternatives --install /usr/bin/python python /usr/bin/python3.7 3</pre><ul><li>é…ç½®æˆåŠŸï¼Œä¼šæç¤ºä½ <code> in auto mode</code>.è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å†æ¬¡æŸ¥çœ‹é…ç½®<br><code>update-alternatives --list python</code></li><li>ä¼šçœ‹åˆ°æˆ‘ä»¬çš„ä¸‰ä¸ªç‰ˆæœ¬å·²ç»æˆåŠŸè¿›è¡Œäº†é…ç½®ã€‚å¦‚æœéœ€è¦åˆ‡æ¢ç‰ˆæœ¬ï¼Œè¾“å…¥å‘½ä»¤<br><code>sudo update-alternatives --config python #  ç„¶åè¾“å…¥ç›¸åº”çš„ç‰ˆæœ¬åºå·å³å¯</code></li><li>æœ€åä½¿ç”¨ï¼š<code>python --version</code>æŸ¥çœ‹ç‰ˆæœ¬å·ï¼Œå¯ä»¥å‘ç°é…ç½®æˆåŠŸ</li></ul><h3 id="5-4-å®‰è£…jtopç®¡ç†GPU">5.4 å®‰è£…jtopç®¡ç†GPU</h3><p>è¾“å…¥å‘½ä»¤å®‰è£…jtopï¼š<br><code>sudo -H pip install jetson-stats</code><br>å®‰è£…æˆåŠŸåï¼Œè¾“å…¥<code>sudo jtop</code>å³å¯æŸ¥çœ‹ç¡¬ä»¶ç›¸å…³ä¿¡æ¯</p><h3 id="5-5-å®‰è£…virtualenvæ¥åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ">5.5 å®‰è£…virtualenvæ¥åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ</h3><ol><li>å®‰è£…ä¸é…ç½®</li></ol><ul><li>ä½¿ç”¨pipä¸‹è½½virtualenv</li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> pip <span class="token function">install</span> virtualenv virtualenvwrapper<span class="token function">vim</span> ~/.bashrc<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><ul><li>å°†ä»¥ä¸‹å†…å®¹è¾“å…¥å…¶ä¸­ï¼š</li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment">#virtualenv and virtualenvwrapper</span><span class="token builtin class-name">export</span> <span class="token assign-left variable">WORKON_HOME</span><span class="token operator">=</span><span class="token environment constant">$HOME</span>/.virtualenvs <span class="token comment">#æŒ‡å®šæ‰€æœ‰çš„éœ€æ‹Ÿç¯å¢ƒçš„å®‰è£…ä½ç½®</span><span class="token builtin class-name">export</span> <span class="token assign-left variable">VIRTUALENVWRAPPER_PYTHON</span><span class="token operator">=</span>/usr/bin/python3.6 <span class="token comment">#æŒ‡å®šè§£é‡Šå™¨ï¼Œæ”¹ä¸ºcudaå¯¹åº”çš„pythonç‰ˆæœ¬</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><ul><li>ç»ˆç«¯è¾“å…¥æŒ‡ä»¤æ¿€æ´»virtualenv</li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">mkdir</span> <span class="token environment constant">$HOME</span>/.virtualenvs<span class="token builtin class-name">source</span> /usr/local/bin/virtualenvwrapper.sh <span class="token comment">#è¿›è¡Œæ¿€æ´»ç”Ÿæ•ˆ</span><span class="token builtin class-name">source</span> ~/.bashrc <span class="token comment">#é‡æ–°è½½å…¥</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><ol start="2"><li>virtualenvçš„ä½¿ç”¨ç›¸å…³æ“ä½œ</li></ol><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">mkvirtualenv name <span class="token comment"># åˆ›å»ºä¸€ä¸ªç¯å¢ƒ</span>mkvirtualenv <span class="token parameter variable">-p</span> /pythonç›®å½•/python.exe name <span class="token comment"># ä¸ä½¿ç”¨é»˜è®¤pythonç‰ˆæœ¬ã€ä½¿ç”¨æŒ‡å®špythonç‰ˆæœ¬åˆ›å»ºç¯å¢ƒ</span>workon name <span class="token comment"># æ¿€æ´»ç¯å¢ƒ</span>deactivate <span class="token comment"># é€€å‡º</span>rmvirtualenv name <span class="token comment"># åˆ é™¤</span>lsvirtualenv <span class="token comment"># æ‰€æœ‰ç¯å¢ƒ</span>cpvirtualenv source_name dest_name <span class="token comment"># å¤åˆ¶è™šæ‹Ÿç¯å¢ƒ</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="å…­ã€å®‰è£…pytorchä»¥åŠtorchvision">å…­ã€å®‰è£…pytorchä»¥åŠtorchvision</h2><h3 id="6-1-åŸºæœ¬æ“ä½œ">6.1 åŸºæœ¬æ“ä½œ</h3><ol><li>åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ<br>[^å£°æ˜]: ä»¥åˆ›å»ºè™šæ‹Ÿç¯å¢ƒåä½torchliï¼Œå®‰è£…1.10.0ç‰ˆæœ¬çš„pytorchå’Œå¯¹åº”ç‰ˆæœ¬0.11.1çš„torchvisionä¸ºä¾‹</li></ol><ul><li>ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ</li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">Mkvirtualenv <span class="token parameter variable">-p</span> /usr/bin/python3.6 torchli <span class="token comment"># -p åé¢è·Ÿç€çš„æ˜¯åˆ¶å®špythonçš„ç‰ˆæœ¬ï¼Œå› ä¸ºæœ‰çš„pytorchå¯¹pythonç‰ˆæœ¬æœ‰è¦æ±‚ï¼Œæ‰€ä»¥è¦æŒ‡å®šç‰ˆæœ¬</span>workon torchli <span class="token comment"># è¿›å…¥è™šæ‹Ÿç¯å¢ƒ</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><ul><li>å¦‚æœé‡è§<code>workon command not find</code>ï¼Œåˆ™ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤<br><code>Source virtualenvwrapper.sh</code></li><li>ç„¶åå†<code>workon torchli</code></li></ul><ol start="2"><li>å®‰è£…pytorch</li></ol><ul><li>é¦–å…ˆä¸‹è½½pytorch pip wheelsï¼ˆå¯¹åº”è‡ªå·±è£…çš„Jatpackçš„ç‰ˆæœ¬ï¼‰<br>[ä¸‹è½½ç½‘å€]:<a href="https://forums.developer.nvidia.com/t/pytorch-for-jetson/72048">https://forums.developer.nvidia.com/t/pytorch-for-jetson/72048</a></li><li>ä¸‹è½½å®Œåï¼Œè¾“å…¥å‘½ä»¤ï¼š</li></ul><pre name="code" class="python">pip install torch-1.10.0-cp36-cp36m-linux_aarch64.whl # å®‰è£…pytorchgit clone --branch v0.11.1 https://github.com/pytorch/vision torchvision # ä¸‹è½½0.11.1ç‰ˆæœ¬cd torchvisionexport BUILD_VERSION=0.11.1python setup.py install --user # --userå¯åŠ å¯ä¸åŠ </pre><ol start="3"><li>éªŒè¯æ˜¯å¦å®‰è£…æˆåŠŸ</li></ol><ul><li>ä¸Šè¿°æ“ä½œå®Œæˆåï¼Œè¾“å…¥å‘½ä»¤ï¼š</li></ul><pre name="code" class="python">python # è¿›å…¥pythonï¼šimport torch # å¯¼å…¥torchåº“torch.cuda.is_available()  # éªŒè¯cudaæ˜¯å¦èƒ½ä½¿ç”¨ï¼Œè¾“å‡ºåº”ä¸ºTrueï¼Œåˆ™pytorchå®‰è£…æˆåŠŸimport torchvision # å¯¼å…¥torchvisionåº“print(Torchvision.__version__) # æ‰“å°ç‰ˆæœ¬å·ï¼ŒæœªæŠ¥é”™å³æˆåŠŸ</pre><h3 id="6-2-é—®é¢˜åŠè§£å†³">6.2 é—®é¢˜åŠè§£å†³</h3><p>6.2.1. æ¿€æ´»ç¯å¢ƒå¤±è´¥ï¼ŒæŠ¥é”™è¾“å‡ºï¼š<code>workon command not find</code><br>è¾“å…¥å‘½ä»¤<code>source virtualenvwrapper.sh # è¾“å…¥ä¹‹åå†å°è¯•æ¿€æ´»å³å¯</code><br>6.2.2. import torchæ—¶æŠ¥é”™,Illegal instruction (core dumped)</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># ä¿®æ”¹ç¯å¢ƒå˜é‡</span><span class="token function">sudo</span> gedit /etc/profile <span class="token builtin class-name">export</span> <span class="token assign-left variable">OPENBLAS_CORETYPE</span><span class="token operator">=</span>ARMV8 <span class="token comment"># å°†å…¶åŠ å…¥æœ€åé¢ä¸€è¡Œï¼Œç„¶åä¿å­˜</span><span class="token comment"># æ›´æ–°ç¯å¢ƒå˜é‡</span><span class="token builtin class-name">source</span> /etc/profile<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>6.2.3. import torchvisionæŠ¥é”™<br>[è¯¥æŠ¥é”™å¤§è‡´å¯ä»¥åˆ†ä¸ºä¸¤ä¸ªé—®é¢˜]: 1ã€pillowå’Œtorchvisionç‰ˆæœ¬ä¸å¯¹åº”å‡ºé”™ï¼›2ã€å½“å‰è·¯å¾„å«æœ‰åŒåæ–‡ä»¶å¯¼è‡´æŠ¥é”™</p><ol><li>åœ¨import torchvisionè¿‡ç¨‹ä¸­é‡åˆ°æœ‰å…³PILåº“çš„æç¤ºæŠ¥é”™<br>è§£å†³æ–¹æ³•ï¼šå°è¯•å¸è½½å½“å‰çš„pillowï¼Œå®‰è£…è¾ƒä½ç‰ˆæœ¬çš„pillow<br>è¾“å…¥å‘½ä»¤ï¼š<pre name="code" class="python">pip uninstall pillowpip install pillow==6.1 # ä¸€èˆ¬æ¥è¯´å®‰è£…æ­¤ç‰ˆæœ¬å³å¯è§£å†³é—®é¢˜</pre></li><li>ç”±äºå½“å‰åœ¨torchvisionæ–‡ä»¶å¤¹ä¸‹å®‰è£…çš„torchvisionï¼Œè‹¥ä¸é€€å‡ºæ­¤è·¯å¾„ä¹Ÿä¼šå¯¼è‡´import torchvisionæŠ¥é”™ï¼ŒæŠ¥é”™æç¤ºè·¯å¾„é—®é¢˜<br>è§£å†³æ–¹æ³•ï¼šé€€å‡ºå½“å‰æ–‡ä»¶å¤¹è·¯å¾„ï¼Œè¾“å…¥ä»¥ä¸‹å‘½ä»¤ï¼š<br><code>cd .. # è¿”å›ä¸Šçº§è·¯å¾„ï¼Œç„¶åå†æ¬¡å°è¯•import torchvision</code></li></ol><h2 id="ä¸ƒã€å®‰è£…opencv">ä¸ƒã€å®‰è£…opencv</h2><h3 id="7-1-æƒ…å½¢ä¸€">7.1 æƒ…å½¢ä¸€</h3><p><a href="%E5%A6%82%E6%9E%9C%E5%9C%A8%E5%AE%89%E8%A3%85jetpack%E6%97%B6%E6%9C%AA%E5%AE%89%E8%A3%85opencv%EF%BC%8C%E6%88%96%E8%80%85%E6%98%AF%E6%83%B3%E6%8D%A2%E6%96%B0%E7%9A%84%E7%89%88%E6%9C%AC%EF%BC%8C%E5%A6%823.4.5%E3%80%82%E5%88%99%E5%8F%AF%E4%BB%A5%E4%BD%BF%E7%94%A8%E4%BB%A5%E4%B8%8B%E6%96%B9%E6%B3%95%E5%AE%89%E8%A3%85opencv">^å…·ä½“é˜è¿°</a>: åœ¨æ–°åˆ›å»ºçš„pythonè™šæ‹Ÿç¯å¢ƒä¸­ï¼Œæ— æ³•import cv2ï¼Œä¸”pip install opencv-pythonå§‹ç»ˆæ— æ³•å®Œæˆï¼Œæ•…éœ€è¦å®‰è£…opencvï¼Œä½†æ˜¯ä¸€èˆ¬æ¥è¯´ï¼Œå®‰è£…jetpackåï¼Œè‡ªåŠ¨å®‰è£…çš„æœ‰opencvï¼Œè‹¥æ­¤opencvç‰ˆæœ¬ä¸å½±å“ä½ çš„ä»£ç ï¼Œé‚£ä¹ˆå°±å¯ä»¥è¿›è¡Œä»¥ä¸‹æ“ä½œä¾¿æ·ä½¿ç”¨opencvåº“äº†</p><ol><li>é¦–å…ˆåœ¨ç»ˆç«¯æ‰§è¡Œä»¥ä¸‹æŒ‡ä»¤æŸ¥æ‰¾ç¼–è¯‘å¥½çš„cv2åº“æ–‡ä»¶çš„è·¯å¾„</li></ol><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">find</span> / <span class="token parameter variable">-iname</span> <span class="token string">"*cv2*"</span> <span class="token comment"># å¾—åˆ°ç±»ä¼¼è·¯å¾„/usr/lib/python3.6/dist-packages/cv2/python-3.6/cv2.cython-36m-aarch64-linux-gnu.soï¼Œé‡ç‚¹æ˜¯cv2.cython-36m-aarch64-linux-gnu.soæ–‡ä»¶è¦æ±‚ä¸€è‡´</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ol start="2"><li>éšåè¿›å…¥è™šæ‹Ÿç¯å¢ƒçš„site-packagesæ–‡ä»¶å¤¹ä¸‹,å¹¶é“¾æ¥åˆ°æŸ¥æ‰¾åˆ°çš„cv2åº“æ–‡ä»¶è·¯å¾„å³å¯</li></ol><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">cd</span> /home/nx407/.virtualenv/torchli/lib/python3.6/site-packages <span class="token comment"># å…¶ä¸­nx407æ˜¯ç”¨æˆ·åã€torchliæ˜¯æˆ‘å»ºç«‹çš„è™šæ‹Ÿç¯å¢ƒå</span><span class="token function">ln</span> <span class="token parameter variable">-s</span> /usr/lib/python3.6/dist-packages/cv2/python-3.6/cv2.cython-36m-aarch64-linux-gnu.so cv2.so  <span class="token comment"># æ³¨æ„lnï¼Œlinkçš„æ„æ€ï¼Œä¸æ˜¯å¤§å†™i</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><ol start="3"><li>å®‰è£…å®Œæˆåï¼Œåœ¨è™šæ‹Ÿç¯å¢ƒä¸­æ‰§è¡Œä¸‹åˆ—æŒ‡ä»¤ä»¥ç¡®ä¿pythonèƒ½æ­£ç¡®è°ƒç”¨cv2ã€‚</li></ol><pre class="line-numbers language-python" data-language="python"><code class="language-python">python               <span class="token operator">//</span>è¿›å…¥python<span class="token keyword">import</span> cv2cv2<span class="token punctuation">.</span>__version__    <span class="token operator">//</span>è‹¥å®‰è£…æˆåŠŸä¸”èƒ½æ­£å¸¸è°ƒç”¨ï¼Œæ­¤å¤„èƒ½è¾“å‡ºå®‰è£…çš„ä»vç‰ˆæœ¬quit<span class="token punctuation">(</span><span class="token punctuation">)</span>               <span class="token operator">//</span>é€€å‡ºpython<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h3 id="7-2-æƒ…å½¢äºŒ">7.2 æƒ…å½¢äºŒ</h3><ol><li><p>æŸ¥çœ‹å·²é¢„å®‰è£…Opencvç‰ˆæœ¬<br><code>pkg-config --modversion opencv</code></p></li><li><p>å¸è½½åŸOpencv</p></li></ol><ul><li>å¦‚æœæ˜¯è‡ªå·±ä¹‹å‰å®‰è£…çš„è¯ï¼Œå°±æ‰¾åˆ°å½“åˆå®‰è£…Opencvçš„buildæ–‡ä»¶å¤¹è·¯å¾„ï¼Œç„¶åè¿›å…¥è¯¥buildç›®å½•æ‰§è¡Œå¸è½½æ“ä½œï¼š</li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">cd</span> <span class="token punctuation">..</span>./opencv-4.x.x/build<span class="token function">sudo</span> <span class="token function">make</span> uninstall<span class="token builtin class-name">cd</span> <span class="token punctuation">..</span>./opencv-4.x.x<span class="token function">sudo</span> <span class="token function">rm</span> <span class="token parameter variable">-r</span> build<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><ul><li>è‹¥ä¸æ˜¯åˆ™æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š</li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">apt-get</span> purge libopencv*<span class="token function">sudo</span> <span class="token function">apt-get</span> purge python-numpy<span class="token function">sudo</span> <span class="token function">apt</span> autoremove // åˆ é™¤å…¶ä»–æœªä½¿ç”¨çš„aptåŒ…ï¼Œå¯æœ‰å¯æ— <span class="token function">sudo</span> <span class="token function">apt-get</span> update<span class="token function">sudo</span> <span class="token function">apt-get</span> dist-upgrade<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><ol start="3"><li><p>ä¸‹è½½Opencv3.4.5.zipæ–‡ä»¶</p></li><li><p>å®‰è£…ä¸€äº›ç›¸å…³åº“å’ŒåŒ…</p></li></ol><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">apt-get</span> installbuild-essential <span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> cmake <span class="token function">git</span> libgtk2.0-dev pkg-config libavcodec-dev libavformat-dev libswscale-dev<span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> python-dev python-numpy libtbb2 libtbb-dev libjpeg-dev libpng-dev libtiff-dev libjasper-dev libdc1394-22-dev<span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> --only-upgrade g++-5 cpp-5 gcc-5<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>å¦‚æœä¸Šè¿°æŒ‡ä»¤å¤±è´¥çš„è¯ï¼Œå¯ä»¥å°è¯•ç½‘ä¸Šæ¢æºï¼Œå¦‚ä¸‹<br>æ›´æ–°åå†å®‰è£…Qt5<br><code>sudo apt-get install qt5-default # qt5å¿…é¡»è¦å®‰è£…æˆåŠŸï¼Œä¸è¿‡ä¸¢åŒ…æ¦‚ç‡ä¸å¤§ï¼Œéƒ½èƒ½è£…ä¸Šçš„</code></p><ol start="5"><li><p>CUDAéƒ¨åˆ†æºç çš„ä¿®æ”¹<br>å…ˆæ‰¾åˆ°<code>cuda_gl_interop.h</code>æ–‡ä»¶ï¼Œä¸€èˆ¬éƒ½æ˜¯åœ¨<code>/usr/local/cuda/include</code>é‡Œ<br>ç„¶ååœ¨å‘½ä»¤æ¡†è¾“å…¥<br><code>sudo gedit /usr/local/cuda/include/cuda_gl_interop.h</code><br>è¿™æ—¶ä¼šå¼¹å‡ºä¸€ä¸ªæ–‡ä»¶å¦‚ä¸‹å›¾<br><img src="/images/Jetson/image-20230322013045837.png" alt="image-20230322013045837"><br>æ‰¾åˆ°çº¢æ¡†å†…ä»£ç ï¼Œå¹¶æŒ‰ç…§å›¾ä¸­ä»£ç æ›´æ”¹ä¸ºä»¥ä¸Šå†…å®¹ï¼Œç„¶åç‚¹saveä¿å­˜ï¼Œé€€å‡ºã€‚</p></li><li><p>å¼€å§‹ç¼–è¯‘å®‰è£…opencv-3.4.5<br>æ‰¾åˆ°opencv-3.4.5æ‰€åœ¨æ–‡ä»¶å¤¹ï¼ˆå³å‰æ–‡è§£å‹åçš„æ–‡ä»¶å¤¹ï¼‰ï¼Œç„¶åcdåˆ°buildæ–‡ä»¶å¤¹é‡Œé¢ã€‚<br>æ§åˆ¶å°è¾“å…¥ï¼š</p></li></ol><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">cmake <span class="token parameter variable">-D</span> <span class="token assign-left variable">CMAKE_BUILD_TYPE</span><span class="token operator">=</span>RELEASE <span class="token parameter variable">-D</span> <span class="token assign-left variable">CMAKE_INSTALL_PREFIX</span><span class="token operator">=</span>/usr/local <span class="token punctuation">\</span>      <span class="token parameter variable">-D</span> <span class="token assign-left variable">WITH_CUDA</span><span class="token operator">=</span>ON <span class="token parameter variable">-D</span> <span class="token assign-left variable">CUDA_ARCH_BIN</span><span class="token operator">=</span><span class="token string">"6.2"</span> <span class="token parameter variable">-D</span> <span class="token assign-left variable">CUDA_ARCH_PTX</span><span class="token operator">=</span><span class="token string">""</span> <span class="token punctuation">\</span>      <span class="token parameter variable">-D</span> <span class="token assign-left variable">WITH_CUBLAS</span><span class="token operator">=</span>ON <span class="token parameter variable">-D</span> <span class="token assign-left variable">ENABLE_FAST_MATH</span><span class="token operator">=</span>ON <span class="token parameter variable">-D</span> <span class="token assign-left variable">CUDA_FAST_MATH</span><span class="token operator">=</span>ON <span class="token punctuation">\</span>      <span class="token parameter variable">-D</span> <span class="token assign-left variable">ENABLE_NEON</span><span class="token operator">=</span>ON <span class="token parameter variable">-D</span> <span class="token assign-left variable">WITH_LIBV4L</span><span class="token operator">=</span>ON <span class="token parameter variable">-D</span> <span class="token assign-left variable">BUILD_TESTS</span><span class="token operator">=</span>OFF <span class="token punctuation">\</span>      <span class="token parameter variable">-D</span> <span class="token assign-left variable">BUILD_PERF_TESTS</span><span class="token operator">=</span>OFF <span class="token parameter variable">-D</span> <span class="token assign-left variable">BUILD_EXAMPLES</span><span class="token operator">=</span>OFF <span class="token punctuation">\</span>      <span class="token parameter variable">-D</span> <span class="token assign-left variable">WITH_QT</span><span class="token operator">=</span>ON <span class="token parameter variable">-D</span> <span class="token assign-left variable">WITH_OPENGL</span><span class="token operator">=</span>ON<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ¥ç€è¾“å…¥ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">make</span><span class="token function">sudo</span> <span class="token function">make</span> <span class="token function">install</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><ol start="7"><li>é…ç½®opencvç¯å¢ƒï¼š<br><code>sudo gedit /etc/ld.so.conf.d/opencv.conf # åˆ›å»ºå¹¶æ‰“å¼€è¯¥æ–‡ä»¶ï¼Œè¾“å…¥ä»¥ä¸‹å†…å®¹</code><br><img src="/images/Jetson/image-20230322013134812.png" alt="image-20230322013134812"><br>æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ï¼Œä½¿å¾—åˆšæ‰é…ç½®çš„è·¯å¾„ç”Ÿæ•ˆ<br><code>sudo ldconfig</code><br>ç„¶åæ‰“å¼€bash.bashrcæ–‡ä»¶<br><code>sudo gedit /etc/bash.bashrc</code><br>åœ¨æ‰“å¼€æ–‡ä»¶çš„æœ€ååŠ å…¥å¦‚ä¸‹å‘½ä»¤</li></ol><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token assign-left variable">PKG_CONFIG_PATH</span><span class="token operator">=</span><span class="token variable">$PKG_CONFIG_PATH</span>:/usr/local/lib/pkgconfig<span class="token builtin class-name">export</span> PKG_CONFIG_PATH<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>å¦‚å›¾ï¼š<br><img src="/images/Jetson/img1.png" alt="img1"><br>ç„¶åä¿å­˜æ–‡ä»¶ï¼Œä½¿å…¶ç”Ÿæ•ˆ<br><code>source /etc/bash.bashrc</code><br>8. æ£€æŸ¥æ˜¯å¦æˆåŠŸå®‰è£…opencv<br>å¯ä»¥å…ˆåœ¨jtopæŸ¥çœ‹opencvçš„å®‰è£…ç‰ˆæœ¬ï¼Œæ­£ç¡®å®‰è£…åä¼šæ˜¾ç¤ºï¼š<br><img src="/images/Jetson/image-20230322013148567.png" alt="image-20230322013148567"><br>9. ä¹‹åè¿æ¥ä¸€ä¸ªæ‘„åƒå¤´ï¼Œåœ¨ç»ˆç«¯è¾“å…¥ï¼Œæµ‹è¯•opencvæ˜¯å¦èƒ½æ­£å¸¸ä½¿ç”¨ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">cd</span> /opencv-3.4.5/samples/cpp/example_cmakecmake <span class="token builtin class-name">.</span><span class="token function">make</span><span class="token comment"># æˆåŠŸmakeåï¼Œæ‰§è¡Œ</span>./opencv_example<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><ol start="10"><li>ä¸Šè¿°<code>./opencv_example</code>å‘½ä»¤å¦‚æœå¤±è´¥ï¼ŒåŸå› å¯èƒ½æ˜¯æ‘„åƒå¤´çš„ç´¢å¼•é”™è¯¯ï¼Œ<br>è¾“å…¥<code>ls usb</code><br>æŸ¥çœ‹æ‘„åƒå¤´ï¼Œå‘ç°video1<br>æ¢ä¸€ä¸ªusbæ¥å£æ’å…¥å³å¯ï¼Œå†æ‰§è¡Œä¸Šè¿°å‘½ä»¤ï¼Œå¯ä»¥å‘ç°æ‘„åƒå¤´æˆåŠŸæ‰“å¼€ã€‚</li></ol>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;ä¸€ã€å‡†å¤‡&quot;&gt;ä¸€ã€å‡†å¤‡&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;Ubuntuç”µè„‘ or è™šæ‹Ÿæœºï¼ˆUbuntuç³»ç»Ÿï¼‰&lt;/li&gt;
&lt;li&gt;èƒ½å¤Ÿè¿›è¡Œæ•°æ®ä¼ è¾“çš„Micro-USBæ•°æ®çº¿&lt;/li&gt;
&lt;li&gt;æ˜¾ç¤ºå± ã€HDMIè½¬æ¥çº¿ã€é”®é¼ &lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&quot;äºŒã€è¿›è¡Œçƒ§å½•</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>æˆåŠŸè§£å†³Pytorchæ¨¡å‹è½¬trtæ¨¡å‹ä¸­å¾—BatchNormé—®é¢˜</title>
    <link href="https://sprli.github.io/2023/05/18/Torch2Trt/"/>
    <id>https://sprli.github.io/2023/05/18/Torch2Trt/</id>
    <published>2023-05-18T06:12:16.513Z</published>
    <updated>2023-05-18T12:37:42.911Z</updated>
    
    <content type="html"><![CDATA[<p>å¦‚æœä½ æƒ³æŠŠä½ çš„æ¨¡å‹æŠ•å…¥åˆ°åº”ç”¨ä¸­æˆ–è€…æ˜¯æƒ³æå‡æ¨¡å‹çš„è¿è¡Œé€Ÿåº¦ï¼Œé™¤äº†å¯¹ç½‘ç»œè¿›è¡Œå‹ç¼©ã€è’¸é¦å¤–ï¼Œæœ€å¥½çš„æ–¹æ³•å°±æ˜¯å°†æ¨¡å‹è½¬æˆtensoræ¨¡å‹ï¼Œä½¿ç”¨tensorrtå®ç°å¯¹ç½‘ç»œçš„åŠ é€Ÿã€‚ä½†æ˜¯å½“è¯¥æ¨¡å‹çš„åŠŸèƒ½æ˜¯å›¾åƒå¢å¼ºæˆ–è€…æ˜¯å›¾åƒç”Ÿæˆï¼Œå¹¶ä¸”æ¨¡å‹ä¸­è¿ç”¨äº†å¤§é‡çš„batchnorm2då‡½æ•°ï¼Œè¿ç”¨ç½‘ä¸Šç°æˆçš„æ–¹æ³•ä¼šå‘ç°æ¨¡å‹è½¬æˆonnxä»¥åŠtrtåï¼Œæ¨¡å‹çš„å¤„ç†æ•ˆæœå¤§å¹…ä¸‹é™ï¼Œæƒ³è§£å†³æ­¤é—®é¢˜å°±å¯ä»¥è¯¦ç»†å¾€ä¸‹çœ‹äº†ï¼š<br>æˆ‘ä»¬çš„æ–¹æ³•é¡ºåºæ˜¯ï¼špytorchæ¨¡å‹å…ˆè½¬æˆonnxæ¨¡å‹ï¼Œæ¥ç€å°†onnxæ¨¡å‹è½¬æˆtrtæ¨¡å‹</p><h2 id="ä¸€ã€pytorch-to-onnx">ä¸€ã€pytorch to onnx</h2><h3 id="æ ¸å¿ƒä»£ç ï¼š">æ ¸å¿ƒä»£ç ï¼š</h3><pre name="code" class="python">import torchfrom torchvision.utils import save_imageimport osfrom nets.tiny_unet_2_channelxiangdeng_RCABup3_1_3 import Decoderimport argparseimport torch.nn as nnfrom torchvision import transforms as Tfrom torchvision.datasets import ImageFolderfrom torch.utils import dataimport onnximport onnxruntimeclass Loader(nn.Module):    def __init__(self, image_dir, batch_size=1, num_workers=4):        super(Loader, self).__init__()        self.image_dir = image_dir        self.batch_size = batch_size        self.num_workers = num_workers    def forward(self):        transform = list()        transform.append(T.Resize([704, 1280]))  # æ³¨æ„è¦ä¸º256çš„å€æ•°        transform.append(T.ToTensor())        transform.append(T.Normalize(mean=(0.5, 0.5, 0.5), std=(0.5, 0.5, 0.5)))        transform = T.Compose(transform)        dataset = ImageFolder(self.image_dir, transform)        data_loader = data.DataLoader(dataset=dataset,                                      batch_size=self.batch_size,                                      num_workers=self.num_workers)        return data_loaderclass Solver(object):    def __init__(self, data_loader, config):        self.data_loader = data_loader        self.global_g_dim = config.global_G_ngf        self.device = torch.device('cuda' if torch.cuda.is_available() else 'cpu')        self.model_save_dir = config.model_save_dir        self.result_dir = config.result_dir        self.build_model()    def restore_model(self, resume_epoch):        """Restore the trained generator and discriminator."""        print('Loading the trained models from step {}...'.format(resume_epoch))        generator_path = os.path.join(self.model_save_dir, '{}-global_G.ckpt'.format(resume_epoch))        self.generator.load_state_dict(torch.load(generator_path, map_location=lambda storage, loc: storage))    def build_model(self):        """create a generator and a discrimin"""        self.generator = Decoder(self.global_g_dim)        self.generator.to(self.device)    def denorm(self, x):        out = (x + 1) / 2        return out.clamp_(0, 1)    def to_numpy(self, tensor):        return tensor.detach().cpu().numpy() if tensor.requires_grad else tensor.cpu().numpy()    def test(self):        begin_epoch = 91        end_epoch = 92        step = 1        for k in range(begin_epoch, end_epoch, step):            self.restore_model(94)            self.generator.train()            modelData = "../model/demo" + str(k) + ".onnx"            # modelData = "demo_distok-1ok" + str(k) + ".onnx"            data_loader = self.data_loader            # with torch.no_grad():            for i, (val_img, _) in enumerate(data_loader):  # å‡ºæ¥çš„å›¾ç‰‡æ˜¯RGBæ ¼å¼, ç”¨PILè¯»å–çš„                if i % 50 != 0:                    continue                x_real_name = data_loader.batch_sampler.sampler.data_source.imgs[i][0]                basename = os.path.basename(x_real_name)                result_path = os.path.join(self.result_dir, str(k))  # ç”Ÿæˆçš„å›¾ç‰‡çš„ä¿å­˜æ–‡ä»¶å¤¹                if not os.path.exists(result_path):                    os.makedirs(result_path)                result_path2 = os.path.join(result_path, basename)                distored_val = val_img.to(self.device)                clean_fake1 = self.generator(distored_val)                torch.cuda.synchronize()                clean_fake1 = clean_fake1.data.cpu()                save_image(self.denorm(clean_fake1), result_path2, nrow=1, padding=0)                torch.onnx.export(self.generator, distored_val, modelData, opset_version=9)                onnx_model = onnx.load(modelData)                onnx.checker.check_model(onnx_model)                ort_session = onnxruntime.InferenceSession(modelData,                                                            providers=['CUDAExecutionProvider'])                ort_inputs = {ort_session.get_inputs()[0].name: self.to_numpy(distored_val)}                ort_outs = ort_session.run(None, ort_inputs)                result_path1 = os.path.join(self.result_dir, "trt"+str(k))                result_pathtrt = os.path.join(result_path1, basename)                #save_image((self.denorm(torch.tensor(ort_outs[0]))),result_pathtrt, nrow=1, padding=0)                result = [val_img, torch.tensor(ort_outs[0]), clean_fake1]                result_concat1 = torch.cat(result, dim=3)                # break                save_image((self.denorm(result_concat1.data.cpu())), result_path2, nrow=2, padding=0)def main(config):    data_loader = Loader(config.data_dir)    solver = Solver(data_loader(), config)    solver.test()    #solver.build_model()    #solver.printnetwork()if __name__ == '__main__':    parser = argparse.ArgumentParser()    parser.add_argument('--global_G_ngf', type=int, default=16, help='number of conv filters in the first layer of G')    parser.add_argument('--num_workers', type=int, default=4)    parser.add_argument('--data_dir', type=str,                        default=r'D:\Data\Paired\underwater_imagenet\val')    parser.add_argument('--model_save_dir', type=str,                        #default='/home/ouc/Li/Torch2TRT/trt_outfile/model'                        default=r'C:\TensorRT-8.6.0.12\samples\python\zzzzFSpiral\modules')    parser.add_argument('--result_dir', type=str,                        default=r'C:\TensorRT-8.6.0.12\samples\python\zzzzFSpiral\result')    torch.cuda.set_device(0)    config = parser.parse_args()    main(config)</pre><p>å½“pytorchè½¬æˆonnxæ—¶ï¼Œéœ€è¦å°†æ¨¡å‹è¿›è¡Œevalæ¨¡å¼ï¼Œå› ä¸ºåœ¨PyTorchä¸­ï¼Œæ¨¡å‹è®­ç»ƒå’Œæ¨ç†ï¼ˆinferenceï¼‰æœ‰ä¸¤ç§æ¨¡å¼ï¼šè®­ç»ƒæ¨¡å¼å’Œè¯„ä¼°æ¨¡å¼ï¼ˆevaluation modeï¼‰ã€‚åœ¨è®­ç»ƒæ¨¡å¼ä¸‹ï¼Œæ¨¡å‹ä¼šä¿ç•™ä¸€äº›ä¸­é—´ç»“æœï¼Œä»¥ä¾¿è¿›è¡Œåå‘ä¼ æ’­å’Œå‚æ•°æ›´æ–°(å¦‚batchnorm2dåœ¨trainå’Œevalæ¨¡å‹ä¸­çš„è®¡ç®—ä¸ä¸€è‡´ï¼Œæ¶‰åŠåˆ°å†…éƒ¨çš„å˜é‡running_meanå’Œrunning_evalçš„è®¡ç®—ï¼ˆå¦‚ä¸‹å›¾æ‰€ç¤ºï¼‰)ã€‚è€Œåœ¨è¯„ä¼°æ¨¡å¼ä¸‹ï¼Œæ¨¡å‹ä¸ä¼šä¿ç•™è¿™äº›ä¸­é—´ç»“æœï¼Œä»¥ä¾¿è¿›è¡Œæ¨ç†ã€‚å› æ­¤ï¼Œåœ¨å°†PyTorchæ¨¡å‹è½¬æ¢ä¸ºONNXæ¨¡å‹æ—¶ï¼Œéœ€è¦å°†æ¨¡å‹åˆ‡æ¢åˆ°è¯„ä¼°æ¨¡å¼ï¼Œä»¥ç¡®ä¿æ¨¡å‹çš„è¾“å‡ºä¸æ¨ç†ç»“æœä¸€è‡´ã€‚å¦‚æœåœ¨è½¬æ¢æ¨¡å‹ä¹‹å‰ä¸å°†æ¨¡å‹åˆ‡æ¢åˆ°è¯„ä¼°æ¨¡å¼ï¼Œå¯èƒ½ä¼šå¯¼è‡´è½¬æ¢åçš„ONNXæ¨¡å‹è¾“å‡ºä¸é¢„æœŸä¸ä¸€è‡´ã€‚å› æ­¤ï¼Œä¸ºäº†ç¡®ä¿è½¬æ¢åçš„ONNXæ¨¡å‹çš„æ­£ç¡®æ€§ï¼Œéœ€è¦å°†PyTorchæ¨¡å‹åˆ‡æ¢åˆ°è¯„ä¼°æ¨¡å¼ï¼ˆeval modeï¼‰å†è¿›è¡Œè½¬æ¢ã€‚</p><pre name="code" class="python">class MyBatchNorm2d(nn.BatchNorm2d):    def __init__(self, num_features, eps=1e-5, momentum=0.1,                 affine=True, track_running_stats=True):        super(MyBatchNorm2d, self).__init__(            num_features, eps, momentum, affine, track_running_stats)    def forward(self, input):        self._check_input_dim(input)        exponential_average_factor = 0.0        if self.training and self.track_running_stats:            if self.num_batches_tracked is not None:                self.num_batches_tracked += 1                if self.momentum is None:  # use cumulative moving average                    exponential_average_factor = 1.0 / float(self.num_batches_tracked)                else:  # use exponential moving average                    exponential_average_factor = self.momentum        # calculate running estimates        if self.training:            mean = input.mean([0, 2, 3])            # use biased var in train            var = input.var([0, 2, 3], unbiased=False)            n = input.numel() / input.size(1)            with torch.no_grad():                self.running_mean = exponential_average_factor * mean\                    + (1 - exponential_average_factor) * self.running_mean                # update running_var with unbiased var                self.running_var = exponential_average_factor * var * n / (n - 1)\                    + (1 - exponential_average_factor) * self.running_var        else:            mean = self.running_mean            var = self.running_var        input = (input - mean[None, :, None, None]) / (torch.sqrt(var[None, :, None, None] + self.eps))        if self.affine:            input = input * self.weight[None, :, None, None] + self.bias[None, :, None, None]        return input</pre><p>å½“æ¨¡å‹æ˜¯trainæ—¶ï¼Œå…¶<code>mean = input.mean([0, 2, 3])ï¼›var = input.var([0, 2, 3], unbiased=False)</code>ï¼Œè®¡ç®—ä¸å½“å‰çš„è¾“å…¥ç›¸æŒ‚é’©ï¼Œä½†æ˜¯å½“æ¨¡å‹æ˜¯evalæ¨¡å¼æ—¶ï¼Œå…¶<code>mean = self.running_meanï¼›var = self.running_var</code>ï¼Œè®¡ç®—ä¸å½“å‰çš„è¾“å…¥æ— å…³ï¼Œè€Œæ˜¯å°†å­¦ä¹ åˆ°çš„running_meanä¸running_varç›´æ¥ä½œä¸ºå½“å‰è®¡ç®—çš„meanä¸varï¼Œç”±äºè¯¥å­¦ä¹ å¾—åˆ°çš„å‡å€¼ä¸æ–¹å·®ï¼ˆrunning_meanä¸running_varï¼‰å¹¶ä¸èƒ½å®Œå…¨é€‚ç”¨æ‰€æœ‰çš„è¾“å…¥æ ·ä¾‹ï¼Œå› æ­¤æ¨¡å‹åœ¨evalæ¨¡å¼ä¸‹çš„å¤„ç†æ•ˆæœæå¤§é™ä½ã€‚</p><p>ä½†æ˜¯æœ‰äººå¯èƒ½ä¼šæƒ³ä¸ºä»€ä¹ˆæ¨¡å‹è½¬æˆonnxæ—¶è¦å°†æ¨¡å‹è®¾ç½®ä¸ºevalæ¨¡å¼ï¼Œç›´æ¥è®¾ç½®ä¸ºtrainæ¨¡å¼ä¸å°±å¯ä»¥è§£å†³å¤„ç†æ•ˆæœä¸‹é™çš„é—®é¢˜äº†å—ï¼Ÿä½†æ˜¯å½“ä½ æŒ‰è¯¥æƒ³æ³•å®éªŒçš„æ—¶å€™ï¼Œä¼šå‘ç°è™½ç„¶pytorchæ¨¡å‹çš„å¤„ç†æ•ˆæœæ²¡é—®é¢˜ï¼Œä½†æ˜¯onnxæ¨¡å‹çš„å¤„ç†æ•ˆæœè¿˜æ˜¯ä¸€æ ·çš„å·®ï¼Œè¿™åˆæ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿæˆ‘çš„çŒœæµ‹æ˜¯onnxæ¨¡å‹åœ¨æ¨ç†æ—¶é»˜è®¤å°†batchnormçš„æ¨¡å¼è®¾ç½®ä¸ºevalï¼Œè¿›è€Œè¾“å‡ºçš„ç»“æœå°±å­˜åœ¨é—®é¢˜äº†ã€‚è¿™ä¸ªæ˜¯æˆ‘ä¸ªäººçš„æƒ³æ³•ï¼Œå¤§å®¶æœ‰ä¸åŒæ„è§å¯ä»¥äº’ç›¸äº¤æµã€‚</p><p>æ‰€ä»¥ç°åœ¨çš„é—®é¢˜å°±è½¬æ¢åˆ°äº†å¦‚ä½•ä½¿æ¨¡å‹åœ¨evalæ¨¡å¼ä¸‹è®¡ç®—çš„meanä¸varå’Œå½“å‰è¾“å…¥ç›¸å…³ï¼Œè€Œä¸æ˜¯ä¾èµ–å­¦ä¹ åˆ°çš„running_meanä¸running_evalã€‚éƒ¨åˆ†äººå¯èƒ½é‡åˆ°æ­¤é—®é¢˜å°±æ— ä»ä¸‹æ‰‹äº†ï¼Œè®¤ä¸ºè¯¥é—®é¢˜æ˜¯æ— æ³•è§£å†³çš„ã€‚ä½†æ˜¯è¿™ä¸ªé—®é¢˜åœ¨æˆ‘è¿™é‡Œæ˜¯èƒ½è§£å†³çš„ã€‚é¦–å…ˆç»è¿‡ä¸Šè¿°å¯¹é—®é¢˜çš„æè¿°ï¼Œå¤§å®¶å¯¹è¿™ä¸ªé—®é¢˜å·²ç»æ˜¯æ¯”è¾ƒæ¸…æ¥šäº†ã€‚</p><p>æ¥ä¸‹æ¥æˆ‘å°†ä»‹ç»ä¸¤ç§å¾ˆç®€å•çš„æ–¹æ³•æ¥è§£å†³onnxæ¨¡å‹å¤„ç†æ•ˆæœå·®çš„é—®é¢˜ï¼š</p><h3 id="æ–¹æ³•ä¸€ï¼š">æ–¹æ³•ä¸€ï¼š</h3><h4 id="å…·ä½“æªæ–½">å…·ä½“æªæ–½:</h4><p>ä¿®æ”¹batchnorm2dä¸­çš„æºç ï¼Œåœ¨if self.trainingï¼šä¸Šæ–¹åŠ ä¸€è¡Œself.training =Trueã€‚è¿™æ ·å°½ç®¡å¤„äºevalæ¨¡å¼ï¼Œä½†æ˜¯batchnormä»ç„¶æ˜¯å¤„äºè®­ç»ƒçŠ¶æ€çš„ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œmeanä¸varè‡ªç„¶å°±å’ŒinputæŒ‚é’©äº†ã€‚<br><img src="/images/Pytorch2trt/image-2.png" style="zoom: 200%;" /></p><h4 id="åˆ©å¼Šï¼š">åˆ©å¼Šï¼š</h4><p>ä¸è¿‡è¿™ç§æ–¹æ³•è™½ç„¶å¯ä»¥è§£å†³onnxæ¨¡å‹å¤„ç†æ•ˆæœå·®çš„é—®é¢˜ï¼Œä½†æ˜¯ç”±è¯¥æ–¹æ³•è·å¾—çš„onnxæ¨¡å‹æ˜¯æ— æ³•æˆåŠŸè½¬tensorrtçš„ã€‚åŸå› æ˜¯å› ä¸ºonnxæ¨¡å‹çš„å‚æ•°éƒ½æ˜¯å›ºå®šæ­»çš„ï¼Œæ­£å¦‚ä¸Šè¿°æˆ‘æ‰€å±•ç¤ºçš„ä»£ç ä¸­ï¼Œå½“æ¨¡å‹å¤„äºè®­ç»ƒæ¨¡å¼æ—¶ï¼Œrunning_meanä¸running_varæ˜¯å˜åŒ–çš„ï¼Œå› æ­¤è·å¾—çš„onnxå°½ç®¡è¾“å‡ºæ²¡é—®é¢˜ï¼Œä½†å…¶å†…éƒ¨æ˜¯å­˜åœ¨é—®é¢˜çš„ã€‚<br>batchnorm2dçš„æºä»£ç è·¯å¾„å¦‚ä¸‹:<br><code>C:\Users\Spring\Anaconda3\envs\torchli\Lib\site-packages\torch\nn\modules\batchnorm.py</code></p><h3 id="æ–¹æ³•äºŒ">æ–¹æ³•äºŒ</h3><h4 id="å…·ä½“æªæ–½-2">å…·ä½“æªæ–½:</h4><p>ä¿®æ”¹batchnorm2dçš„æºç ï¼Œä¸è¿‡ä¸æ–¹æ³•ä¸€æœ‰æ‰€åŒºåˆ«ï¼Œå…·ä½“ä¿®æ”¹è§ä¸‹å›¾ï¼Œä¹‹æ‰€ä»¥è¿™æ ·ä¿®æ”¹æ˜¯å› ä¸ºbatchnormåœ¨evalæ¨¡å¼ä¸‹ï¼Œmeanä¸varå’Œrunning_meanä¸running_valæŒ‚é’©ï¼Œæ•…æˆ‘ä»¬æå‰å°†å­¦ä¹ åˆ°çš„running_meanä¸running_varè®¾ç½®æˆä¸inputæŒ‚é’©ï¼Œç„¶åå°±meanä¸varå°±å’Œinputè”ç³»èµ·æ¥äº†ã€‚<br><img src="/images/Pytorch2trt/image-20230514162311051.png" style="zoom: 200%;" /></p><h4 id="åˆ©å¼Šï¼š-2">åˆ©å¼Šï¼š</h4><p>ä¸è¿‡è¿™ç§æ–¹æ³•è™½ç„¶å¯ä»¥è§£å†³onnxæ¨¡å‹å¤„ç†æ•ˆæœå·®çš„é—®é¢˜ï¼Œä½†æ˜¯å½“å¯è§†åŒ–ç”±è¯¥æ–¹æ³•è·å¾—çš„onnxæ¨¡å‹æ—¶ï¼Œä¼šå‘ç°batchnormæ˜¯ä¸çº¯å‡€çš„ï¼Œä¸Šæ–¹å¤šäº†ä¸€äº›è®¡ç®—åˆ†æ”¯ï¼ˆå¦‚å³å›¾æ‰€ç¤ºï¼‰ï¼Œä½†æ˜¯æ–¹æ³•ä¸€çš„batchnormæ˜¯çº¯å‡€çš„ï¼ˆå¦‚å·¦å›¾æ‰€ç¤ºï¼‰ã€‚å¥½å¤„æ˜¯ç”±è¯¥æ–¹æ³•è·å¾—çš„onnxæ¨¡å‹æ˜¯å¯ä»¥é¡ºåˆ©è½¬æˆtrtæ¨¡å‹çš„ã€‚<br><img src="/images/Pytorch2trt/image-1.png" style="zoom:150%;" /></p><h2 id="äºŒã€onnx-to-trt">äºŒã€onnx to trt</h2><h3 id="ç»ˆç«¯è½¬æ¢å‘½ä»¤ï¼š">ç»ˆç«¯è½¬æ¢å‘½ä»¤ï¼š</h3><p>Windows<br><code>.\trtexec.exe --onnx=aaa.onnx --saveEngine=retinate_hat_hair_beard_sim.trt --device=0</code><br>Ubuntu<br><code>trtexec --onnx=aaa.onnx --saveEngine=retinate_hat_hair_beard_sim.trt --device=0</code></p><h3 id="ä½¿ç”¨trtæ¨¡å‹è¿›è¡Œæ¨ç†ï¼š">ä½¿ç”¨trtæ¨¡å‹è¿›è¡Œæ¨ç†ï¼š</h3><pre name="code" class="python">import torchfrom torch.autograd import Variableimport tensorrt as trtimport pycuda.driver as cudafrom torchvision.utils import save_imageimport osimport pycuda.gpuarray as gpuarrayimport pycuda.autoinitfrom torchvision import datasets, transformsfrom torch.utils.data import DataLoaderfrom torchvision import transforms as Tfrom torchvision.datasets import ImageFolderimport timeimport numpy as npfrom torch.utils import dataimport torch.nn as nnimport time# æ“ä½œç¼“å­˜ï¼Œè¿›è¡Œè¿ç®—ï¼Œ è¿™ä¸ªå‡½æ•°æ˜¯é€šç”¨çš„def infer(context, input_img, output_size, batch_size=1):    # Convert input data to Float32,è¿™ä¸ªç±»å‹è¦è½¬æ¢ï¼Œä¸ä¸¥ä¼šæœ‰å¥½å¤šæŠ¥é”™    input_img = input_img.astype(np.float32)    # Create output array to receive data    output = np.empty(output_size, dtype=np.float32)    # output = np.empty(batch_size * output.nbytes)    # Allocate device memory    d_input = cuda.mem_alloc(batch_size * input_img.nbytes)    d_output = cuda.mem_alloc(batch_size * output.nbytes)    bindings = [int(d_input), int(d_output)]    stream = cuda.Stream()    # Transfer input data to device    cuda.memcpy_htod_async(d_input, input_img, stream)    # Execute model    context.execute_async(batch_size, bindings, stream.handle, None)    # Transfer predictions back    cuda.memcpy_dtoh_async(output, d_output, stream)    stream.synchronize()    # Return predictions    return outputclass Loader(nn.Module):    def __init__(self, image_dir, batch_size=1, num_workers=4):        super(Loader, self).__init__()        self.image_dir = image_dir        self.batch_size = batch_size        self.num_workers = num_workers    def forward(self):        transform = list()        transform.append(T.Resize([704, 1280]))  # æ³¨æ„è¦ä¸º256çš„å€æ•°        transform.append(T.ToTensor())        transform.append(T.Normalize(mean=(0.5, 0.5, 0.5), std=(0.5, 0.5, 0.5)))        transform = T.Compose(transform)        dataset = ImageFolder(self.image_dir, transform)        data_loader = data.DataLoader(dataset=dataset,                                      batch_size=self.batch_size,                                      num_workers=self.num_workers)        return data_loaderdef denorm(x):    out = (x + 1) / 2    return out.clamp_(0, 1)# æ‰§è¡Œæµ‹è¯•å‡½æ•°def do_test(context, batch_size=1):    # train_loader = DataLoader(train_dataset, batch_size=batch_size, shuffle=True)    test_loader = Loader(image_dir='/home/ouc/LiModel/data-paired/underwater_imagenet/val/')    print("mnist data load successful!!!")    accurary = 0    start_time = time.time()    times = []    for i, (val_img, _) in enumerate(test_loader()):    # å¼€å§‹æµ‹è¯•        # img, label = data        x_real_name = test_loader().batch_sampler.sampler.data_source.imgs[i][0]        basename = os.path.basename(x_real_name)        img = val_img.numpy()    # è¿™ä¸ªæ•°æ®è¦ä»torch.Tensorè½¬æ¢æˆnumpyæ ¼å¼çš„        # print(img)        # label = Variable(label, volatile=True)        # with torch.no_grad():        #     label = Variable(label)        start_time1 = time.time()        output = infer(context, img, img.shape, 1)        end_time1 = time.time()        print(end_time1 - start_time1)        times.append((end_time1 - start_time1))        result_trt = torch.tensor(output)        # print(result_trt.shape)        # print(val_img.shape)        result = [val_img, result_trt]        result_concat1 = torch.cat(result, dim=3)        save_image((denorm(result_concat1.data.cpu())), '/home/ouc/Desktop/python/zzzzFSpiral/result/trt/' + basename, nrow=2, padding=0)        #print(output)        # conf, pred = torch.max(torch.Tensor(output), -1)        # num_count = (pred == label).sum()        # accurary += num_count.data    end_time = time.time()    print((start_time - end_time)/len(test_loader()))    print(np.mean(times))    # print("Test Acc is {:.6f}".format(accurary / len(test_dataset())))    # return accurary/len(test_dataset), time.time() - start_timedef trt_infer():    # è¯»å–.trtæ–‡ä»¶    def loadEngine2TensorRT(filepath):        G_LOGGER = trt.Logger(trt.Logger.WARNING)        # ååºåˆ—åŒ–å¼•æ“        with open(filepath, "rb") as f, trt.Runtime(G_LOGGER) as runtime:            engine = runtime.deserialize_cuda_engine(f.read())            return engine    trt_model_name = "./resnet3.trt"    engine = loadEngine2TensorRT(trt_model_name)    # åˆ›å»ºä¸Šä¸‹æ–‡    context = engine.create_execution_context()    print("Start TensorRT Test...")    do_test(context)    # print('INT8 acc: {}, need time: {}'.format(acc, times))if __name__ == '__main__':    trt_infer()</pre>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;å¦‚æœä½ æƒ³æŠŠä½ çš„æ¨¡å‹æŠ•å…¥åˆ°åº”ç”¨ä¸­æˆ–è€…æ˜¯æƒ³æå‡æ¨¡å‹çš„è¿è¡Œé€Ÿåº¦ï¼Œé™¤äº†å¯¹ç½‘ç»œè¿›è¡Œå‹ç¼©ã€è’¸é¦å¤–ï¼Œæœ€å¥½çš„æ–¹æ³•å°±æ˜¯å°†æ¨¡å‹è½¬æˆtensoræ¨¡å‹ï¼Œä½¿ç”¨tensorrtå®ç°å¯¹ç½‘ç»œçš„åŠ é€Ÿã€‚ä½†æ˜¯å½“è¯¥æ¨¡å‹çš„åŠŸèƒ½æ˜¯å›¾åƒå¢å¼ºæˆ–è€…æ˜¯å›¾åƒç”Ÿæˆï¼Œå¹¶ä¸”æ¨¡å‹ä¸­è¿ç”¨äº†å¤§é‡çš„batchnorm2då‡½æ•°ï¼Œè¿ç”¨ç½‘ä¸Šç°æˆçš„</summary>
      
    
    
    
    
  </entry>
  
</feed>
